{
    "analysis_id": "a1d4a2b6-0a4d-40ee-944f-73428a224bc2",
    "filename": "06da22b0-69ad-4a95-8e1a-a72c59643fc2_5.SAMSUNG A52S.pcapng",
    "analysis_timestamp": "2026-01-23T09:16:27.892972",
    "total_packets": 23,
    "wlan_packets": 23,
    "analysis_duration_ms": 0,
    "devices": [
        {
            "mac_address": "e6:d3:21:ce:59:dd",
            "oui": "e6:d3:21",
            "vendor": "Samsung",
            "device_model": "SAMSUNG A52S",
            "device_category": "mobile_device",
            "is_virtual": true,
            "confidence_score": 1.0
        }
    ],
    "btm_events": [],
    "transitions": [],
    "btm_requests": 3,
    "btm_responses": 2,
    "btm_success_rate": 0.3333333333333333,
    "successful_transitions": 1,
    "failed_transitions": 0,
    "loops_detected": false,
    "kvr_support": {
        "k_support": false,
        "v_support": true,
        "r_support": false,
        "compliance_score": 0.3333333333333333
    },
    "compliance_checks": [
        {
            "check_name": "Soporte BTM (802.11v)",
            "description": "El dispositivo debe demostrar soporte activo de BSS Transition Management",
            "category": "btm",
            "passed": true,
            "severity": "high",
            "score": 1.0,
            "details": "Requests: 3, Responses: 2\nCode: 0 (Accept)",
            "recommendation": "Habilitar 802.11v"
        },
        {
            "check_name": "Asociación y Reasociación",
            "description": "Verifica ciclos completos de asociación y reasociación",
            "category": "association",
            "passed": true,
            "severity": "medium",
            "score": 1.0,
            "details": "Assoc: 0/1, Reassoc: 4/4\nDisassoc: 0, Deauth: 0",
            "recommendation": null
        },
        {
            "check_name": "Steering Efectivo",
            "description": "Se deben realizar cambios de banda efectivos (2.4 -> 5GHz)",
            "category": "performance",
            "passed": true,
            "severity": "high",
            "score": 1.0,
            "details": "Cambios de banda: 1",
            "recommendation": null
        },
        {
            "check_name": "Estándares KVR",
            "description": "Soporte de estándares de movilidad (Mínimo 2 de 3: k, v, r)",
            "category": "kvr",
            "passed": false,
            "severity": "medium",
            "score": 0.3333333333333333,
            "details": "k=False, v=True, r=False",
            "recommendation": "Se recomienda habilitar el estándar faltante para roaming óptimo"
        }
    ],
    "overall_compliance_score": 0.8333333333333334,
    "verdict": "PARTIAL",
    "analysis_text": "# INFORME TÉCNICO DE AUDITORÍA DE BAND STEERING\n\n## 1. RESUMEN EJECUTIVO\n**Veredicto:** PARCIAL\n\nLa auditoría de Band Steering ha resultado en un veredicto parcial debido a la falta de soporte para el estándar 802.11k, que es crucial para una gestión de movilidad óptima. Aunque se logró una transición exitosa de banda (2.4GHz a 5GHz) y se confirmaron intercambios BTM exitosos con Status Code 0, la ausencia del estándar 802.11k limita la capacidad del cliente para realizar decisiones informadas de roaming. Se detectaron 3 intentos de steering, de los cuales 1 fue exitoso, y no se observaron bucles en las transiciones. \n\n**Hallazgos clave:**\n- 1 transición exitosa de 3 intentos de steering.\n- 2 BTM Requests y 2 BTM Responses con Status Code 0.\n- Soporte de estándares KVR: k=False, v=True, r=False.\n\n---\n\n## 2. ANÁLISIS DE PROTOCOLOS DE ROAMING (802.11k/v/r)\nSe detectó el estándar 802.11v (BTM/WNM) durante la captura, lo que indica que el cliente está cooperando con el AP para la gestión de transiciones de banda. Sin embargo, la ausencia del estándar 802.11k limita la capacidad del cliente para recibir informes de vecinos, lo que podría mejorar la toma de decisiones durante el roaming.\n\n- **BTM Requests:** 2 (AP -> Cliente)\n- **BTM Responses:** 2 (Cliente -> AP)\n- **Status Codes:** 0 (Accept), lo que indica que el cliente aceptó las solicitudes de BTM.\n\nLa falta de 802.11k significa que el cliente no puede recibir información sobre la calidad de las redes disponibles, lo que podría haber optimizado las decisiones de transición.\n\n---\n\n## 3. ANÁLISIS DE TRANSICIONES DE BANDA\nSe registraron 3 intentos de steering, de los cuales 1 fue exitoso. El tiempo promedio de transición fue de 45.733 segundos, lo que indica que el proceso de cambio de banda fue relativamente lento. \n\n- **Transiciones exitosas:** 1\n- **Transiciones fallidas:** 0\n- **Bucles detectados:** NO\n\nLa única transición exitosa fue asistida por el estándar 802.11v, pero el tiempo de transición sugiere que podría haber mejoras en la eficiencia del proceso.\n\n---\n\n## 4. ESTABILIDAD DE ASOCIACIÓN\nLa estabilidad de asociación fue adecuada, con 0 eventos de Deauthentication y 0 desasociaciones. Esto indica que el cliente mantuvo una conexión estable durante la auditoría, lo que es positivo para la experiencia del usuario.\n\n- **Asociaciones:** 0/1\n- **Reasociaciones:** 4/4\n- **Desasociaciones:** 0\n- **Deauth:** 0\n\nLa ausencia de desconexiones forzadas sugiere que el AP no está expulsando al cliente, lo que es un buen indicador de la estabilidad de la red.\n\n---\n\n## 5. CALIDAD DE RED\nLos indicadores de calidad de red son positivos, con 0 retransmisiones TCP, 0 reintentos WLAN y 0 errores DNS. Esto sugiere que la red está funcionando de manera eficiente y que no hay problemas significativos de rendimiento que afecten la experiencia del usuario.\n\n---\n\n## 6. COMPORTAMIENTO DEL CLIENTE\nEl cliente analizado mostró un comportamiento cooperativo al responder a las solicitudes de BTM. Sin embargo, la falta de soporte para 802.11k limita su capacidad para optimizar el roaming. \n\n- **Capacidades detectadas:** Soporte para 802.11v, pero no para 802.11k y 802.11r.\n- **Preferencias de banda:** El cliente parece preferir la banda de 5GHz, pero la falta de información sobre la calidad de la red limita su capacidad para tomar decisiones informadas.\n\n---\n\n## 7. CONCLUSIONES Y RECOMENDACIONES\nLa auditoría de Band Steering ha revelado que, aunque se lograron transiciones exitosas y se mantuvo una buena estabilidad de asociación, la falta de soporte para el estándar 802.11k es una limitación significativa. Esto afecta la capacidad del cliente para realizar decisiones informadas sobre el roaming, lo que podría resultar en una experiencia de usuario subóptima.\n\n### Recomendaciones:\n1. **Habilitar el estándar 802.11k:** Esto permitirá al cliente recibir información sobre la calidad de las redes disponibles, mejorando así la toma de decisiones durante el roaming.",
    "raw_stats": {
        "total_packets": 23,
        "total_tcp_packets": 0,
        "total_wlan_packets": 23,
        "approx_total_bytes": 0,
        "diagnostics": {
            "tcp_retransmissions": 0,
            "wlan_retries": 0,
            "dns_errors": 0,
            "steering_events_count": 9,
            "unique_bssid_count": 3,
            "bssid_info": {
                "f4:2d:06:43:49:3f": {
                    "band": "2.4GHz",
                    "ssid": "483336303150",
                    "frequency": "2412"
                },
                "f4:2d:06:43:49:40": {
                    "band": "5GHz",
                    "ssid": "483336303150",
                    "frequency": "5180"
                },
                "88:1d:fc:0e:d9:b5": {
                    "band": "2.4GHz",
                    "ssid": "",
                    "frequency": "2412"
                }
            },
            "client_mac": "e6:d3:21:ce:59:dd",
            "capture_quality": "VALIDA - Steering detectado y analizado",
            "band_counters": {
                "beacon_24": 0,
                "beacon_5": 0,
                "probe_req": 0,
                "probe_resp_24": 0,
                "probe_resp_5": 0,
                "data_24": 0,
                "data_5": 0,
                "btm_stats": {
                    "requests": 2,
                    "responses": 2,
                    "status_codes": [
                        "0"
                    ]
                },
                "kvr_stats": {
                    "11k": false,
                    "11v": true,
                    "11r": false
                }
            }
        },
        "steering_analysis": {
            "transitions": [
                {
                    "client": "e6:d3:21:ce:59:dd",
                    "type": "assisted",
                    "deauth_time": null,
                    "reassoc_time": 1732738581.255423,
                    "transition_time": 45.73282504081726,
                    "from_bssid": "f4:2d:06:43:49:3f",
                    "to_bssid": "f4:2d:06:43:49:40",
                    "from_band": "2.4GHz",
                    "to_band": "5GHz",
                    "is_band_change": true,
                    "reason_code": null,
                    "status": "TIMEOUT",
                    "returned_to_original": false
                }
            ],
            "steering_attempts": 3,
            "successful_transitions": 1,
            "failed_transitions": 0,
            "loop_detected": false,
            "avg_transition_time": 45.733,
            "max_transition_time": 45.733,
            "transition_times": [
                45.73282504081726
            ],
            "verdict": "EXCELLENT",
            "clients_analyzed": 5,
            "preventive_steering": false
        },
        "steering_events": [
            {
                "timestamp": 1732738535.522598,
                "type": "Reassociation Request",
                "subtype": 2,
                "client_mac": "e6:d3:21:ce:59:dd",
                "bssid": "f4:2d:06:43:49:3f",
                "ssid": "483336303150",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1732738535.526713,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "f4:2d:06:43:49:3f",
                "bssid": "f4:2d:06:43:49:3f",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732738581.255423,
                "type": "Reassociation Request",
                "subtype": 2,
                "client_mac": "e6:d3:21:ce:59:dd",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1732738581.257174,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "f4:2d:06:43:49:40",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732738717.014379,
                "type": "Association Response",
                "subtype": 1,
                "client_mac": "88:1d:fc:0e:d9:b5",
                "bssid": "88:1d:fc:0e:d9:b5",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732738719.306809,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "f4:2d:06:43:49:3f",
                "bssid": "f4:2d:06:43:49:3f",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732738774.60298,
                "type": "Reassociation Request",
                "subtype": 2,
                "client_mac": "9e:70:a1:d7:4f:9f",
                "bssid": "88:1d:fc:0e:d9:b5",
                "ssid": "496e76697461646f735469676f",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1732738796.183513,
                "type": "Reassociation Request",
                "subtype": 2,
                "client_mac": "e6:d3:21:ce:59:dd",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1732738796.185267,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "f4:2d:06:43:49:40",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            }
        ],
        "top_protocols": [
            [
                "radiotap",
                23
            ],
            [
                "wlan_radio",
                23
            ],
            [
                "wlan",
                23
            ]
        ],
        "top_sources": [],
        "top_destinations": []
    },
    "fragments": []
}