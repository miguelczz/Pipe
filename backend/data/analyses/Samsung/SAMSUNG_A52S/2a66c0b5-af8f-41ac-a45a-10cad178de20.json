{
    "analysis_id": "2a66c0b5-af8f-41ac-a45a-10cad178de20",
    "filename": "5.SAMSUNG A52S.pcapng",
    "analysis_timestamp": "2026-01-23T11:36:30.936852",
    "total_packets": 23,
    "wlan_packets": 23,
    "analysis_duration_ms": 0,
    "devices": [
        {
            "mac_address": "e6:d3:21:ce:59:dd",
            "oui": "e6:d3:21",
            "vendor": "Samsung",
            "device_model": "SAMSUNG A52S",
            "device_category": "mobile_device",
            "is_virtual": true,
            "confidence_score": 1.0
        }
    ],
    "btm_events": [],
    "transitions": [],
    "btm_requests": 3,
    "btm_responses": 2,
    "btm_success_rate": 0.3333333333333333,
    "successful_transitions": 1,
    "failed_transitions": 0,
    "loops_detected": false,
    "kvr_support": {
        "k_support": false,
        "v_support": true,
        "r_support": false
    },
    "compliance_checks": [
        {
            "check_name": "Soporte BTM (802.11v)",
            "description": "El dispositivo debe demostrar soporte activo de BSS Transition Management",
            "category": "btm",
            "passed": true,
            "severity": "high",
            "details": "Requests: 3, Responses: 2\nCode: 0 (Accept)",
            "recommendation": "Habilitar 802.11v"
        },
        {
            "check_name": "Asociación y Reasociación",
            "description": "Verifica ciclos completos de asociación y reasociación",
            "category": "association",
            "passed": true,
            "severity": "medium",
            "details": "Assoc: 0/1, Reassoc: 4/4\nDisassoc: 0, Deauth: 0",
            "recommendation": null
        },
        {
            "check_name": "Steering Efectivo",
            "description": "Se deben realizar cambios de banda efectivos (2.4 -> 5GHz)",
            "category": "performance",
            "passed": true,
            "severity": "high",
            "details": "Cambios de banda: 1",
            "recommendation": null
        },
        {
            "check_name": "Estándares KVR",
            "description": "Soporte de estándares de movilidad (Mínimo 2 de 3: k, v, r)",
            "category": "kvr",
            "passed": false,
            "severity": "medium",
            "details": "k=False, v=True, r=False",
            "recommendation": "Se recomienda habilitar el estándar faltante para roaming óptimo"
        }
    ],
    "verdict": "FAILED",
    "analysis_text": "# INFORME TÉCNICO DE AUDITORÍA DE BAND STEERING\n\n## 1. RESUMEN EJECUTIVO\nEl veredicto de la auditoría es **FALLIDA**. La causa raíz del veredicto se debe a la falta de soporte para los estándares KVR, específicamente la ausencia del estándar 802.11k, que es crítico para un roaming óptimo. Durante la captura se detectaron 3 intentos de steering, de los cuales 1 fue exitoso. Se registraron 2 BTM Requests y 2 BTM Responses con un Status Code 0 (Accept), lo que indica que el cliente cooperó en el proceso de steering. Sin embargo, la falta del estándar 802.11k limita la capacidad del cliente para realizar transiciones de banda más eficientes.\n\n## 2. ANÁLISIS TÉCNICO\n\n### Análisis de Protocolos de Roaming (802.11k/v/r)\nSe detectó el uso del estándar 802.11v (BTM/WNM), lo que permitió la comunicación entre el AP y el cliente para gestionar el roaming. Sin embargo, el cliente no soporta 802.11k, lo que impide la obtención de Neighbor Reports que podrían facilitar decisiones de roaming más informadas. La ausencia de 802.11r también limita la capacidad de realizar transiciones rápidas entre bandas.\n\n- **BTM Requests y Responses**: Se registraron 2 BTM Requests enviados por el AP y 2 respuestas del cliente, todas con Status Code 0 (Accept), lo que indica que el cliente está dispuesto a cooperar con el AP en el proceso de steering.\n\n### Análisis de Transiciones de Banda\nSe realizaron 3 intentos de steering, de los cuales 1 fue exitoso. El tiempo promedio de transición fue de 45.733 segundos, lo que es relativamente alto y podría indicar un problema en la eficiencia del proceso de roaming. La única transición exitosa fue de 2.4GHz a 5GHz, y se registró un estado de TIMEOUT, lo que sugiere que el cliente pudo haber tardado más de lo esperado en completar la transición.\n\n- **Transiciones**: \n  - Intentos de steering: 3\n  - Transiciones exitosas: 1\n  - Transiciones fallidas: 0\n  - Tiempo promedio de transición: 45.733s\n\n### Estabilidad de Asociación\nLa estabilidad de asociación fue adecuada, con 4 re-asociaciones exitosas y sin eventos de desconexión forzada (Deauth o Disassoc). Esto indica que el cliente mantuvo una conexión estable con el AP durante la captura.\n\n### Calidad de Red\nLas métricas de calidad de red son óptimas, con 0 retransmisiones TCP, 0 WLAN Retries y 0 errores DNS. Esto sugiere que la red está funcionando correctamente en términos de rendimiento y estabilidad.\n\n### Comportamiento del Cliente\nEl cliente analizado mostró un comportamiento cooperativo al responder a las solicitudes BTM del AP. Sin embargo, la falta de soporte para 802.11k y 802.11r limita su capacidad para realizar transiciones de banda más eficientes y rápidas.\n\n## 3. CONCLUSIÓN FINAL\nEl veredicto de la auditoría es **FALLIDA** debido a la falta de soporte para los estándares KVR, específicamente 802.11k. Aunque se registraron interacciones BTM exitosas y una transición de banda, la ausencia de estándares críticos para el roaming limita la efectividad del steering. Se recomienda habilitar el estándar 802.11k para mejorar la experiencia de roaming y optimizar el rendimiento de la red.",
    "raw_stats": {
        "total_packets": 23,
        "total_tcp_packets": 0,
        "total_wlan_packets": 23,
        "approx_total_bytes": 0,
        "diagnostics": {
            "tcp_retransmissions": 0,
            "wlan_retries": 0,
            "dns_errors": 0,
            "steering_events_count": 9,
            "unique_bssid_count": 3,
            "bssid_info": {
                "f4:2d:06:43:49:3f": {
                    "band": "2.4GHz",
                    "ssid": "483336303150",
                    "frequency": "2412"
                },
                "f4:2d:06:43:49:40": {
                    "band": "5GHz",
                    "ssid": "483336303150",
                    "frequency": "5180"
                },
                "88:1d:fc:0e:d9:b5": {
                    "band": "2.4GHz",
                    "ssid": "",
                    "frequency": "2412"
                }
            },
            "client_mac": "e6:d3:21:ce:59:dd",
            "capture_quality": "VALIDA - Steering detectado y analizado",
            "band_counters": {
                "beacon_24": 0,
                "beacon_5": 0,
                "probe_req": 0,
                "probe_resp_24": 0,
                "probe_resp_5": 0,
                "data_24": 0,
                "data_5": 0,
                "btm_stats": {
                    "requests": 2,
                    "responses": 2,
                    "status_codes": [
                        "0"
                    ]
                },
                "kvr_stats": {
                    "11k": false,
                    "11v": true,
                    "11r": false
                }
            }
        },
        "steering_analysis": {
            "transitions": [
                {
                    "client": "e6:d3:21:ce:59:dd",
                    "type": "assisted",
                    "deauth_time": null,
                    "reassoc_time": 1732738581.255423,
                    "transition_time": 45.73282504081726,
                    "from_bssid": "f4:2d:06:43:49:3f",
                    "to_bssid": "f4:2d:06:43:49:40",
                    "from_band": "2.4GHz",
                    "to_band": "5GHz",
                    "is_band_change": true,
                    "reason_code": null,
                    "status": "TIMEOUT",
                    "returned_to_original": false
                }
            ],
            "steering_attempts": 3,
            "successful_transitions": 1,
            "failed_transitions": 0,
            "loop_detected": false,
            "avg_transition_time": 45.733,
            "max_transition_time": 45.733,
            "transition_times": [
                45.73282504081726
            ],
            "verdict": "EXCELLENT",
            "clients_analyzed": 5,
            "preventive_steering": false
        },
        "steering_events": [
            {
                "timestamp": 1732738535.522598,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "e6:d3:21:ce:59:dd",
                "da": "f4:2d:06:43:49:3f",
                "client_mac": "e6:d3:21:ce:59:dd",
                "bssid": "f4:2d:06:43:49:3f",
                "ssid": "483336303150",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1732738535.526713,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "f4:2d:06:43:49:3f",
                "da": "e6:d3:21:ce:59:dd",
                "client_mac": "f4:2d:06:43:49:3f",
                "bssid": "f4:2d:06:43:49:3f",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732738581.255423,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "e6:d3:21:ce:59:dd",
                "da": "f4:2d:06:43:49:40",
                "client_mac": "e6:d3:21:ce:59:dd",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1732738581.257174,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "f4:2d:06:43:49:40",
                "da": "e6:d3:21:ce:59:dd",
                "client_mac": "f4:2d:06:43:49:40",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732738717.014379,
                "type": "Association Response",
                "subtype": 1,
                "sa": "88:1d:fc:0e:d9:b5",
                "da": "72:43:aa:3f:97:4f",
                "client_mac": "88:1d:fc:0e:d9:b5",
                "bssid": "88:1d:fc:0e:d9:b5",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732738719.306809,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "f4:2d:06:43:49:3f",
                "da": "e6:d3:21:ce:59:dd",
                "client_mac": "f4:2d:06:43:49:3f",
                "bssid": "f4:2d:06:43:49:3f",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732738774.60298,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "9e:70:a1:d7:4f:9f",
                "da": "88:1d:fc:0e:d9:b5",
                "client_mac": "9e:70:a1:d7:4f:9f",
                "bssid": "88:1d:fc:0e:d9:b5",
                "ssid": "496e76697461646f735469676f",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1732738796.183513,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "e6:d3:21:ce:59:dd",
                "da": "f4:2d:06:43:49:40",
                "client_mac": "e6:d3:21:ce:59:dd",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1732738796.185267,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "f4:2d:06:43:49:40",
                "da": "e6:d3:21:ce:59:dd",
                "client_mac": "f4:2d:06:43:49:40",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            }
        ],
        "top_protocols": [
            [
                "radiotap",
                23
            ],
            [
                "wlan_radio",
                23
            ],
            [
                "wlan",
                23
            ]
        ],
        "top_sources": [],
        "top_destinations": []
    },
    "fragments": []
}