{
    "analysis_id": "1c1ffe23-2d25-4e98-881e-22b74d784e7b",
    "filename": "16.SAMSUNG A31.pcapng",
    "analysis_timestamp": "2026-01-23T11:13:48.705333",
    "total_packets": 35,
    "wlan_packets": 35,
    "analysis_duration_ms": 0,
    "devices": [
        {
            "mac_address": "f6:3b:bc:2b:a8:76",
            "oui": "f6:3b:bc",
            "vendor": "Samsung",
            "device_model": "SAMSUNG A31",
            "device_category": "mobile_device",
            "is_virtual": true,
            "confidence_score": 1.0
        }
    ],
    "btm_events": [],
    "transitions": [],
    "btm_requests": 7,
    "btm_responses": 2,
    "btm_success_rate": 0.14285714285714285,
    "successful_transitions": 1,
    "failed_transitions": 4,
    "loops_detected": true,
    "kvr_support": {
        "k_support": false,
        "v_support": true,
        "r_support": false
    },
    "compliance_checks": [
        {
            "check_name": "Soporte BTM (802.11v)",
            "description": "El dispositivo debe demostrar soporte activo de BSS Transition Management",
            "category": "btm",
            "passed": true,
            "severity": "high",
            "details": "Requests: 7, Responses: 2\nCode: 0 (Accept)",
            "recommendation": "Habilitar 802.11v"
        },
        {
            "check_name": "Asociación y Reasociación",
            "description": "Verifica ciclos completos de asociación y reasociación",
            "category": "association",
            "passed": false,
            "severity": "medium",
            "details": "Assoc: 3/3, Reassoc: 3/6\nDisassoc: 0, Deauth: 1",
            "recommendation": "Prueba FALLIDA: Se detectaron 1 Deauth y 0 Disassoc DIRIGIDOS al cliente, indicando inestabilidad forzada."
        },
        {
            "check_name": "Steering Efectivo",
            "description": "Se deben realizar cambios de banda efectivos (2.4 -> 5GHz)",
            "category": "performance",
            "passed": true,
            "severity": "high",
            "details": "Cambios de banda: 1",
            "recommendation": null
        },
        {
            "check_name": "Estándares KVR",
            "description": "Soporte de estándares de movilidad (Mínimo 2 de 3: k, v, r)",
            "category": "kvr",
            "passed": false,
            "severity": "medium",
            "details": "k=False, v=True, r=False",
            "recommendation": "Se recomienda habilitar el estándar faltante para roaming óptimo"
        }
    ],
    "verdict": "FAILED",
    "analysis_text": "# INFORME TÉCNICO DE AUDITORÍA DE BAND STEERING\n\n**Archivo:** 16.SAMSUNG A31.pcapng  \n**Paquetes WLAN analizados:** 35  \n**Eventos 802.11 capturados:** 19  \n**Calidad de captura:** VALIDA - Steering detectado y analizado  \n\n---\n\n## 1. RESUMEN EJECUTIVO\n\n**Veredicto Final AIDLC:** FAILED\n\nLa auditoría de Band Steering ha resultado en un veredicto FALLIDO debido a problemas críticos en los procesos de asociación y re-asociación, así como la falta de soporte para estándares de movilidad. Se detectaron 1 evento de Deauthentication y 0 eventos de Disassociation dirigidos al cliente, lo que indica inestabilidad en la conexión. Además, el cliente solo soporta 802.11v, careciendo de 802.11k y 802.11r, lo que limita su capacidad de roaming efectivo. \n\n**Hallazgos clave:**\n- **Asociación y Reasociación:** 3/3 asociaciones exitosas, pero solo 3/6 re-asociaciones exitosas.\n- **Eventos de Deauthentication:** 1 evento detectado.\n- **Transiciones de Banda:** 7 intentos de steering, con solo 1 transición exitosa y 4 fallidas.\n- **Bucles detectados:** Sí, lo que indica problemas en la gestión de la conexión.\n\n---\n\n## 2. ANÁLISIS TÉCNICO\n\n### Análisis de Protocolos de Roaming (802.11k/v/r)\n\nSe detectó el uso de 802.11v (BTM/WNM), lo que indica que el cliente está cooperando con el AP para la gestión de la transición de bandas. Sin embargo, la ausencia de 802.11k (Neighbor Reports) y 802.11r (Fast Transition) limita la capacidad del cliente para realizar decisiones informadas sobre el roaming. \n\n- **BTM Requests:** 2 solicitudes enviadas desde el AP al cliente, con 2 respuestas del cliente, todas con Status Code 0 (Accept), lo que indica que el cliente está dispuesto a cooperar.\n- **Impacto:** La falta de 802.11k y 802.11r significa que el cliente no puede beneficiarse de un roaming más eficiente, lo que contribuye a la inestabilidad observada.\n\n### Análisis de Transiciones de Banda\n\nSe realizaron 7 intentos de steering, de los cuales solo 1 fue exitoso. Los detalles de las transiciones son los siguientes:\n\n1. **Transición Asistida (802.11k/v/r):** \n   - Cliente: f6:3b:bc:2b:a8:76\n   - Tiempo: 118.083s\n   - Estado: TIMEOUT (fallida)\n\n2. **Transiciones Agresivas (Deauth):**\n   - Se detectaron múltiples eventos de Deauthentication que resultaron en bucles, donde el cliente no logró re-asociarse correctamente, lo que indica un comportamiento problemático en la gestión de la conexión.\n\n**Bucles detectados:** Se observaron múltiples eventos de bucle en la misma banda, lo que indica que el cliente no pudo cambiar de banda de manera efectiva, resultando en un estado de conexión inestable.\n\n### Estabilidad de Asociación\n\n- **Asociaciones:** 3 de 3 exitosas.\n- **Reasociaciones:** 3 de 6 exitosas, lo que indica un problema en la capacidad del cliente para mantener la conexión al cambiar de banda.\n- **Eventos de Deauthentication:** 1 evento detectado, lo que indica que el AP está forzando la desconexión del cliente en lugar de permitir un cambio de banda suave.\n\n### Calidad de Red\n\nLos indicadores de calidad de red son positivos, con 0 retransmisiones TCP/WLAN y 0 errores DNS, lo que sugiere que, cuando el cliente está conectado, la calidad de la conexión es adecuada. Sin embargo, la inestabilidad en la asociación y re-asociación afecta negativamente la experiencia del usuario.\n\n### Comportamiento del Cliente\n\nEl cliente analizado muestra una disposición a cooperar con el AP a través de BTM, pero la falta de soporte para 802.11k y 802.11r limita su capacidad para realizar transiciones de banda efectivas. Esto se traduce en una experiencia de usuario subóptima, especialmente en entornos donde la movilidad es crítica.\n\n---\n\n## 3. CONCLUSIÓN FINAL\n\nLa auditoría de Band Steering ha resultado en un veredicto FALLIDO debido a problemas críticos en los procesos de asociación y re-asociación, así como la falta de soporte para estándares de movilidad. Se recomienda habilitar 802.11k y 802.11r en el cliente para mejorar la capacidad de roaming y evitar problemas de inestabilidad en la conexión. La implementación de estos estándares es crucial para optimizar la experiencia del usuario y garantizar un rendimiento adecuado en entornos de red Wi-Fi.",
    "raw_stats": {
        "total_packets": 35,
        "total_tcp_packets": 0,
        "total_wlan_packets": 35,
        "approx_total_bytes": 0,
        "diagnostics": {
            "tcp_retransmissions": 0,
            "wlan_retries": 0,
            "dns_errors": 0,
            "steering_events_count": 19,
            "unique_bssid_count": 2,
            "bssid_info": {
                "00:19:c6:51:00:24": {
                    "band": "2.4GHz",
                    "ssid": "483336303150",
                    "frequency": "2462"
                },
                "00:19:c6:51:00:25": {
                    "band": "5GHz",
                    "ssid": "483336303150",
                    "frequency": "5180"
                }
            },
            "client_mac": "f6:3b:bc:2b:a8:76",
            "capture_quality": "VALIDA - Steering detectado y analizado",
            "band_counters": {
                "beacon_24": 0,
                "beacon_5": 0,
                "probe_req": 0,
                "probe_resp_24": 0,
                "probe_resp_5": 0,
                "data_24": 0,
                "data_5": 0,
                "btm_stats": {
                    "requests": 2,
                    "responses": 2,
                    "status_codes": [
                        "0"
                    ]
                },
                "kvr_stats": {
                    "11k": false,
                    "11v": true,
                    "11r": false
                }
            }
        },
        "steering_analysis": {
            "transitions": [
                {
                    "client": "f6:3b:bc:2b:a8:76",
                    "type": "assisted",
                    "deauth_time": null,
                    "reassoc_time": 1724380040.974058,
                    "transition_time": 118.08270502090454,
                    "from_bssid": "00:19:c6:51:00:24",
                    "to_bssid": "00:19:c6:51:00:25",
                    "from_band": "2.4GHz",
                    "to_band": "5GHz",
                    "is_band_change": true,
                    "reason_code": null,
                    "status": "TIMEOUT",
                    "returned_to_original": false
                },
                {
                    "client": "f6:3b:bc:2b:a8:76",
                    "type": "aggressive",
                    "deauth_time": 1724380123.422703,
                    "reassoc_time": null,
                    "transition_time": null,
                    "from_bssid": "00:19:c6:51:00:25",
                    "to_bssid": null,
                    "from_band": "5GHz",
                    "to_band": null,
                    "is_band_change": null,
                    "reason_code": "0x0003",
                    "status": "NO_REASSOC",
                    "returned_to_original": false
                },
                {
                    "client": "00:19:c6:51:00:25",
                    "type": "aggressive",
                    "deauth_time": 1724379817.798471,
                    "reassoc_time": 1724379820.292016,
                    "transition_time": 2.4935450553894043,
                    "from_bssid": "00:19:c6:51:00:25",
                    "to_bssid": "00:19:c6:51:00:25",
                    "from_band": "5GHz",
                    "to_band": "5GHz",
                    "is_band_change": false,
                    "reason_code": "0x0002",
                    "status": "LOOP",
                    "returned_to_original": true
                },
                {
                    "client": "00:19:c6:51:00:25",
                    "type": "aggressive",
                    "deauth_time": 1724379823.388442,
                    "reassoc_time": 1724379849.059728,
                    "transition_time": 25.67128586769104,
                    "from_bssid": "00:19:c6:51:00:25",
                    "to_bssid": "00:19:c6:51:00:25",
                    "from_band": "5GHz",
                    "to_band": "5GHz",
                    "is_band_change": false,
                    "reason_code": "0x0002",
                    "status": "LOOP",
                    "returned_to_original": true
                },
                {
                    "client": "00:19:c6:51:00:25",
                    "type": "aggressive",
                    "deauth_time": 1724380011.970867,
                    "reassoc_time": 1724380040.975684,
                    "transition_time": 29.004817008972168,
                    "from_bssid": "00:19:c6:51:00:25",
                    "to_bssid": "00:19:c6:51:00:25",
                    "from_band": "5GHz",
                    "to_band": "5GHz",
                    "is_band_change": false,
                    "reason_code": "0x0002",
                    "status": "LOOP",
                    "returned_to_original": true
                }
            ],
            "steering_attempts": 7,
            "successful_transitions": 1,
            "failed_transitions": 4,
            "loop_detected": true,
            "avg_transition_time": 43.813,
            "max_transition_time": 118.083,
            "transition_times": [
                118.08270502090454,
                2.4935450553894043,
                25.67128586769104,
                29.004817008972168
            ],
            "verdict": "ACCEPTABLE",
            "clients_analyzed": 5,
            "preventive_steering": false
        },
        "steering_events": [
            {
                "timestamp": 1724379753.939396,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "f6:3b:bc:2b:a8:76",
                "da": "00:19:c6:51:00:24",
                "client_mac": "f6:3b:bc:2b:a8:76",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "483336303150",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1724379753.943019,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "f6:3b:bc:2b:a8:76",
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724379753.945657,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "f6:3b:bc:2b:a8:76",
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724379814.700914,
                "type": "Association Request",
                "subtype": 0,
                "sa": "6a:b7:65:bd:28:92",
                "da": "00:19:c6:51:00:25",
                "client_mac": "6a:b7:65:bd:28:92",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1724379814.702541,
                "type": "Association Response",
                "subtype": 1,
                "sa": "00:19:c6:51:00:25",
                "da": "6a:b7:65:bd:28:92",
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724379817.798471,
                "type": "Deauthentication",
                "subtype": 12,
                "sa": "00:19:c6:51:00:25",
                "da": "6a:b7:65:bd:28:92",
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "0x0002",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1724379820.290398,
                "type": "Association Request",
                "subtype": 0,
                "sa": "32:58:b6:a4:e1:24",
                "da": "00:19:c6:51:00:25",
                "client_mac": "32:58:b6:a4:e1:24",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1724379820.292016,
                "type": "Association Response",
                "subtype": 1,
                "sa": "00:19:c6:51:00:25",
                "da": "32:58:b6:a4:e1:24",
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724379823.388442,
                "type": "Deauthentication",
                "subtype": 12,
                "sa": "00:19:c6:51:00:25",
                "da": "32:58:b6:a4:e1:24",
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "0x0002",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1724379849.059728,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:25",
                "da": "f6:3b:bc:2b:a8:76",
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724379922.891353,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "f6:3b:bc:2b:a8:76",
                "da": "00:19:c6:51:00:24",
                "client_mac": "f6:3b:bc:2b:a8:76",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "483336303150",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1724379922.894852,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "f6:3b:bc:2b:a8:76",
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724379922.897614,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "f6:3b:bc:2b:a8:76",
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724380008.872821,
                "type": "Association Request",
                "subtype": 0,
                "sa": "6a:b7:65:bd:28:92",
                "da": "00:19:c6:51:00:25",
                "client_mac": "6a:b7:65:bd:28:92",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1724380008.874438,
                "type": "Association Response",
                "subtype": 1,
                "sa": "00:19:c6:51:00:25",
                "da": "6a:b7:65:bd:28:92",
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724380011.970867,
                "type": "Deauthentication",
                "subtype": 12,
                "sa": "00:19:c6:51:00:25",
                "da": "6a:b7:65:bd:28:92",
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "0x0002",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1724380040.974058,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "f6:3b:bc:2b:a8:76",
                "da": "00:19:c6:51:00:25",
                "client_mac": "f6:3b:bc:2b:a8:76",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1724380040.975684,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:25",
                "da": "f6:3b:bc:2b:a8:76",
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724380123.422703,
                "type": "Deauthentication",
                "subtype": 12,
                "sa": "f6:3b:bc:2b:a8:76",
                "da": "00:19:c6:51:00:25",
                "client_mac": "f6:3b:bc:2b:a8:76",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "0x0003",
                "assoc_status_code": ""
            }
        ],
        "top_protocols": [
            [
                "radiotap",
                35
            ],
            [
                "wlan_radio",
                35
            ],
            [
                "wlan",
                35
            ]
        ],
        "top_sources": [],
        "top_destinations": []
    },
    "fragments": []
}