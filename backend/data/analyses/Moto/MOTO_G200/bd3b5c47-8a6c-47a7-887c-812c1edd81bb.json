{
    "analysis_id": "bd3b5c47-8a6c-47a7-887c-812c1edd81bb",
    "filename": "15.MOTO G200.pcapng",
    "analysis_timestamp": "2026-01-27T11:52:49.460456",
    "total_packets": 15,
    "wlan_packets": 15,
    "analysis_duration_ms": 1,
    "devices": [
        {
            "mac_address": "b8:98:ad:ad:46:d0",
            "oui": "b8:98:ad",
            "vendor": "Moto",
            "device_model": "MOTO G200",
            "device_category": "mobile_device",
            "is_virtual": false,
            "confidence_score": 1.0
        }
    ],
    "btm_events": [],
    "transitions": [
        {
            "client_mac": "00:19:c6:51:00:24",
            "steering_type": "unknown",
            "start_time": 1724398454.969727,
            "end_time": 1724398454.969727,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:24",
            "to_bssid": "00:19:c6:51:00:24",
            "from_band": "2.4GHz",
            "to_band": "2.4GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        },
        {
            "client_mac": "00:19:c6:51:00:24",
            "steering_type": "unknown",
            "start_time": 1724398454.972728,
            "end_time": 1724398454.972728,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:24",
            "to_bssid": "00:19:c6:51:00:24",
            "from_band": "2.4GHz",
            "to_band": "2.4GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        },
        {
            "client_mac": "00:19:c6:51:00:24",
            "steering_type": "unknown",
            "start_time": 1724398569.278717,
            "end_time": 1724398569.278717,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:24",
            "to_bssid": "00:19:c6:51:00:24",
            "from_band": "2.4GHz",
            "to_band": "2.4GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        },
        {
            "client_mac": "00:19:c6:51:00:24",
            "steering_type": "unknown",
            "start_time": 1724398569.281723,
            "end_time": 1724398569.281723,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:24",
            "to_bssid": "00:19:c6:51:00:24",
            "from_band": "2.4GHz",
            "to_band": "2.4GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        },
        {
            "client_mac": "00:19:c6:51:00:25",
            "steering_type": "unknown",
            "start_time": 1724398517.078231,
            "end_time": 1724398517.078231,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:25",
            "to_bssid": "00:19:c6:51:00:25",
            "from_band": "5GHz",
            "to_band": "5GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        },
        {
            "client_mac": "00:19:c6:51:00:25",
            "steering_type": "unknown",
            "start_time": 1724398612.299493,
            "end_time": 1724398612.299493,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:25",
            "to_bssid": "00:19:c6:51:00:25",
            "from_band": "5GHz",
            "to_band": "5GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        }
    ],
    "signal_samples": [
        {
            "timestamp": 1724398454.940115,
            "rssi": -90,
            "band": "2.4GHz",
            "frequency": 2462
        },
        {
            "timestamp": 1724398454.957609,
            "rssi": -60,
            "band": "2.4GHz",
            "frequency": 2462
        },
        {
            "timestamp": 1724398517.061374,
            "rssi": -68,
            "band": "5GHz",
            "frequency": 5180
        },
        {
            "timestamp": 1724398517.076488,
            "rssi": -68,
            "band": "5GHz",
            "frequency": 5180
        },
        {
            "timestamp": 1724398612.283654,
            "rssi": -80,
            "band": "5GHz",
            "frequency": 5180
        },
        {
            "timestamp": 1724398612.297764,
            "rssi": -82,
            "band": "5GHz",
            "frequency": 5180
        }
    ],
    "btm_requests": 1,
    "btm_responses": 0,
    "btm_success_rate": 0.0,
    "successful_transitions": 0,
    "failed_transitions": 1,
    "loops_detected": false,
    "kvr_support": {
        "k_support": false,
        "v_support": true,
        "r_support": false
    },
    "compliance_checks": [
        {
            "check_name": "Soporte BTM (802.11v)",
            "description": "El dispositivo debe demostrar soporte activo de BSS Transition Management",
            "category": "btm",
            "passed": false,
            "severity": "high",
            "details": "Request: 1, Response: 0",
            "recommendation": "El cliente ignora o rechaza solicitudes BTM. Revisar códigos de estado."
        },
        {
            "check_name": "Asociación y Reasociación",
            "description": "Verifica ciclos completos de asociación y reasociación",
            "category": "association",
            "passed": true,
            "severity": "medium",
            "details": "Assoc: 0/0, Reassoc: 3/6\nDisassoc: 0, Deauth: 0",
            "recommendation": null
        },
        {
            "check_name": "Steering Efectivo",
            "description": "Se deben realizar cambios de banda estables (2.4 -> 5GHz)",
            "category": "performance",
            "passed": false,
            "severity": "high",
            "details": "Cambios detectados: 0",
            "recommendation": "No se detectaron transiciones de banda efectivas. Verificar que la captura contenga el flujo completo de steering."
        },
        {
            "check_name": "Estándares KVR",
            "description": "Soporte de estándares de movilidad (Mínimo 2 de 3: k, v, r)",
            "category": "kvr",
            "passed": false,
            "severity": "medium",
            "details": "k=False, v=True, r=False",
            "recommendation": "Se recomienda habilitar el estándar faltante para roaming óptimo"
        }
    ],
    "verdict": "FAILED",
    "analysis_text": "# INFORME TÉCNICO DE AUDITORÍA DE BAND STEERING\n\n## 1. RESUMEN EJECUTIVO\n**Veredicto Final:** FALLIDA\n\nLa auditoría de Band Steering ha resultado en un veredicto de FALLIDA debido a los siguientes checks que no se cumplieron:\n\n- **Soporte BTM (802.11v): FALLÓ** - El cliente no demostró soporte activo para BSS Transition Management, con 1 solicitud y 0 respuestas.\n- **Steering Efectivo: FALLÓ** - No se detectaron transiciones de banda efectivas, con 0 cambios exitosos.\n- **Estándares KVR: FALLÓ** - El cliente no soporta los estándares necesarios para un roaming óptimo, específicamente 802.11k y 802.11r.\n\nDurante la captura se analizaron 15 paquetes WLAN, de los cuales se registraron 9 eventos 802.11. Se identificaron 3 clientes, pero solo se realizó un intento de steering, el cual falló. El tiempo promedio de transición fue de 62.119 segundos, lo que indica una falta de eficiencia en el proceso de cambio de banda.\n\n## 2. ANÁLISIS TÉCNICO\n\n### Análisis de Protocolos de Roaming (802.11k/v/r)\nLa captura no mostró evidencia de soporte para BSS Transition Management (BTM), ya que no se detectaron eventos BTM. Esto es crítico, ya que el BTM permite que los clientes gestionen de manera más efectiva su transición entre bandas. La ausencia de solicitudes y respuestas BTM indica que el cliente está ignorando o rechazando estas solicitudes, lo que limita su capacidad para realizar transiciones de banda informadas.\n\n### Análisis de Transiciones de Banda\nSe registró un único intento de transición de banda desde 2.4GHz a 5GHz, el cual falló con un estado de TIMEOUT. Esto sugiere que el cliente no pudo completar la transición, lo que es indicativo de un problema en la gestión del steering. La falta de transiciones exitosas (0 de 1) resalta la ineficacia del mecanismo de steering implementado.\n\n### Estabilidad de Asociación\nEl análisis de la estabilidad de asociación muestra que no hubo eventos de desconexión forzada (Deauth) y que se registraron 3 reasociaciones. Esto indica que, aunque el cliente se mantuvo conectado, no se logró un cambio efectivo de banda, lo que impacta negativamente en la experiencia del usuario.\n\n### Calidad de Red\nLos indicadores de calidad de red son positivos, con 0 retransmisiones TCP, 0 errores de DNS y 0 reintentos WLAN. Sin embargo, estos datos no compensan la falta de efectividad en el steering, ya que la calidad de la conexión no se traduce en un manejo adecuado de las bandas.\n\n### Comportamiento del Cliente\nEl cliente analizado no soporta 802.11k (Neighbor Reports) y 802.11r (Fast Transition), lo que limita su capacidad para realizar transiciones de banda eficientes. Solo se detectó soporte para 802.11v, lo que no es suficiente para un rendimiento óptimo en entornos de múltiples bandas.\n\n## 3. CONCLUSIÓN FINAL\nLa auditoría de Band Steering ha resultado en un veredicto de FALLIDA debido a la falta de soporte para BTM, la ineficacia en las transiciones de banda y la ausencia de estándares KVR necesarios para un roaming óptimo. Se recomienda revisar la configuración del cliente para habilitar los estándares faltantes y asegurar que el dispositivo pueda gestionar adecuadamente las transiciones entre bandas, mejorando así la experiencia del usuario en la red.",
    "raw_stats": {
        "total_packets": 15,
        "total_tcp_packets": 0,
        "total_wlan_packets": 15,
        "approx_total_bytes": 0,
        "diagnostics": {
            "tcp_retransmissions": 0,
            "wlan_retries": 0,
            "dns_errors": 0,
            "steering_events_count": 9,
            "unique_bssid_count": 2,
            "bssid_info": {
                "00:19:c6:51:00:24": {
                    "band": "2.4GHz",
                    "ssid": "483336303150",
                    "frequency": "2462"
                },
                "00:19:c6:51:00:25": {
                    "band": "5GHz",
                    "ssid": "483336303150",
                    "frequency": "5180"
                }
            },
            "client_mac": "b8:98:ad:ad:46:d0",
            "capture_quality": "VALIDA - Steering fallido pero analizable",
            "band_counters": {
                "beacon_24": 0,
                "beacon_5": 0,
                "probe_req": 0,
                "probe_resp_24": 0,
                "probe_resp_5": 0,
                "data_24": 0,
                "data_5": 0
            }
        },
        "steering_analysis": {
            "transitions": [
                {
                    "client": "b8:98:ad:ad:46:d0",
                    "type": "assisted",
                    "deauth_time": null,
                    "reassoc_time": 1724398517.076488,
                    "transition_time": 62.118879079818726,
                    "from_bssid": "00:19:c6:51:00:24",
                    "to_bssid": "00:19:c6:51:00:25",
                    "from_band": "2.4GHz",
                    "to_band": "5GHz",
                    "is_band_change": true,
                    "reason_code": null,
                    "status": "TIMEOUT",
                    "returned_to_original": false
                }
            ],
            "steering_attempts": 1,
            "successful_transitions": 0,
            "failed_transitions": 1,
            "loop_detected": false,
            "avg_transition_time": 62.119,
            "max_transition_time": 62.119,
            "transition_times": [
                62.118879079818726
            ],
            "verdict": "FAILED",
            "clients_analyzed": 3,
            "preventive_steering": false
        },
        "steering_events": [
            {
                "timestamp": 1724398454.957609,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:24",
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "483336303150",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-60"
            },
            {
                "timestamp": 1724398454.969727,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "b8:98:ad:ad:46:d0",
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-82"
            },
            {
                "timestamp": 1724398454.972728,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "b8:98:ad:ad:46:d0",
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-82"
            },
            {
                "timestamp": 1724398517.076488,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:25",
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-68"
            },
            {
                "timestamp": 1724398517.078231,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:25",
                "da": "b8:98:ad:ad:46:d0",
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-18"
            },
            {
                "timestamp": 1724398569.278717,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "b8:98:ad:ad:46:d0",
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-68"
            },
            {
                "timestamp": 1724398569.281723,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "b8:98:ad:ad:46:d0",
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-68"
            },
            {
                "timestamp": 1724398612.297764,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:25",
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-82"
            },
            {
                "timestamp": 1724398612.299493,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:25",
                "da": "b8:98:ad:ad:46:d0",
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-18"
            }
        ],
        "signal_samples": [
            {
                "timestamp": 1724398454.940115,
                "rssi": -90,
                "band": "2.4GHz",
                "frequency": 2462,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:24"
            },
            {
                "timestamp": 1724398454.957609,
                "rssi": -60,
                "band": "2.4GHz",
                "frequency": 2462,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:24"
            },
            {
                "timestamp": 1724398517.061374,
                "rssi": -68,
                "band": "5GHz",
                "frequency": 5180,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:25"
            },
            {
                "timestamp": 1724398517.076488,
                "rssi": -68,
                "band": "5GHz",
                "frequency": 5180,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:25"
            },
            {
                "timestamp": 1724398612.283654,
                "rssi": -80,
                "band": "5GHz",
                "frequency": 5180,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:25"
            },
            {
                "timestamp": 1724398612.297764,
                "rssi": -82,
                "band": "5GHz",
                "frequency": 5180,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:25"
            }
        ],
        "top_protocols": [
            [
                "radiotap",
                15
            ],
            [
                "wlan_radio",
                15
            ],
            [
                "wlan",
                15
            ]
        ],
        "top_sources": [],
        "top_destinations": []
    },
    "fragments": []
}