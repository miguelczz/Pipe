{
    "analysis_id": "65a0542b-73ae-460a-8118-e67e38172589",
    "filename": "15.MOTO G200.pcapng",
    "analysis_timestamp": "2026-01-27T15:10:02.726753",
    "total_packets": 15,
    "wlan_packets": 15,
    "analysis_duration_ms": 0,
    "devices": [
        {
            "mac_address": "b8:98:ad:ad:46:d0",
            "oui": "b8:98:ad",
            "vendor": "Moto",
            "device_model": "MOTO G200",
            "device_category": "mobile_device",
            "is_virtual": false,
            "confidence_score": 1.0
        }
    ],
    "btm_events": [],
    "transitions": [
        {
            "client_mac": "b8:98:ad:ad:46:d0",
            "steering_type": "unknown",
            "start_time": 1724398454.969727,
            "end_time": 1724398454.969727,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:24",
            "to_bssid": "00:19:c6:51:00:24",
            "from_band": "2.4GHz",
            "to_band": "2.4GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        },
        {
            "client_mac": "b8:98:ad:ad:46:d0",
            "steering_type": "unknown",
            "start_time": 1724398454.972728,
            "end_time": 1724398454.972728,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:24",
            "to_bssid": "00:19:c6:51:00:24",
            "from_band": "2.4GHz",
            "to_band": "2.4GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        },
        {
            "client_mac": "b8:98:ad:ad:46:d0",
            "steering_type": "unknown",
            "start_time": 1724398517.078231,
            "end_time": 1724398517.078231,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:25",
            "to_bssid": "00:19:c6:51:00:25",
            "from_band": "5GHz",
            "to_band": "5GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        },
        {
            "client_mac": "b8:98:ad:ad:46:d0",
            "steering_type": "unknown",
            "start_time": 1724398569.278717,
            "end_time": 1724398569.278717,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:24",
            "to_bssid": "00:19:c6:51:00:24",
            "from_band": "2.4GHz",
            "to_band": "2.4GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        },
        {
            "client_mac": "b8:98:ad:ad:46:d0",
            "steering_type": "unknown",
            "start_time": 1724398569.281723,
            "end_time": 1724398569.281723,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:24",
            "to_bssid": "00:19:c6:51:00:24",
            "from_band": "2.4GHz",
            "to_band": "2.4GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        },
        {
            "client_mac": "b8:98:ad:ad:46:d0",
            "steering_type": "unknown",
            "start_time": 1724398612.299493,
            "end_time": 1724398612.299493,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:25",
            "to_bssid": "00:19:c6:51:00:25",
            "from_band": "5GHz",
            "to_band": "5GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        }
    ],
    "signal_samples": [
        {
            "timestamp": 1724398454.940115,
            "rssi": -90,
            "band": "2.4GHz",
            "frequency": 2462
        },
        {
            "timestamp": 1724398454.957609,
            "rssi": -60,
            "band": "2.4GHz",
            "frequency": 2462
        },
        {
            "timestamp": 1724398517.061374,
            "rssi": -68,
            "band": "5GHz",
            "frequency": 5180
        },
        {
            "timestamp": 1724398517.076488,
            "rssi": -68,
            "band": "5GHz",
            "frequency": 5180
        },
        {
            "timestamp": 1724398612.283654,
            "rssi": -80,
            "band": "5GHz",
            "frequency": 5180
        },
        {
            "timestamp": 1724398612.297764,
            "rssi": -82,
            "band": "5GHz",
            "frequency": 5180
        }
    ],
    "btm_requests": 3,
    "btm_responses": 0,
    "btm_success_rate": 0.0,
    "successful_transitions": 0,
    "failed_transitions": 3,
    "loops_detected": true,
    "kvr_support": {
        "k_support": false,
        "v_support": true,
        "r_support": false
    },
    "compliance_checks": [
        {
            "check_name": "Soporte BTM (802.11v)",
            "description": "El dispositivo debe demostrar soporte activo de BSS Transition Management",
            "category": "btm",
            "passed": false,
            "severity": "high",
            "details": "Request: 3, Response: 0",
            "recommendation": "El cliente ignora o rechaza solicitudes BTM. Revisar códigos de estado."
        },
        {
            "check_name": "Asociación y Reasociación",
            "description": "Verifica ciclos completos de asociación y reasociación",
            "category": "association",
            "passed": true,
            "severity": "medium",
            "details": "Assoc: 0/0, Reassoc: 3/6\nDisassoc: 0, Deauth: 0",
            "recommendation": null
        },
        {
            "check_name": "Steering Efectivo",
            "description": "Se deben realizar cambios de banda estables (2.4 -> 5GHz)",
            "category": "performance",
            "passed": false,
            "severity": "high",
            "details": "Cambios detectados: 0",
            "recommendation": "No se detectaron transiciones de banda efectivas. Verificar que la captura contenga el flujo completo de steering."
        },
        {
            "check_name": "Estándares KVR",
            "description": "Soporte de estándares de movilidad (Mínimo 2 de 3: k, v, r)",
            "category": "kvr",
            "passed": false,
            "severity": "medium",
            "details": "k=False, v=True, r=False",
            "recommendation": "Se recomienda habilitar el estándar faltante para roaming óptimo"
        }
    ],
    "verdict": "FAILED",
    "analysis_text": "# INFORME TÉCNICO DE AUDITORÍA DE BAND STEERING\n\n## 1. RESUMEN EJECUTIVO\n**Veredicto Final:** FALLIDA\n\nLa auditoría de Band Steering ha resultado en un veredicto de FALLIDA debido a los siguientes checks que no se cumplieron:\n\n- **Soporte BTM (802.11v): FALLÓ** - El cliente no demostró soporte activo para BSS Transition Management, con 0 respuestas a las solicitudes BTM.\n- **Steering Efectivo: FALLÓ** - No se registraron transiciones de banda efectivas, a pesar de los intentos de steering.\n- **Estándares KVR: FALLÓ** - El cliente no soporta los estándares necesarios para un roaming óptimo, específicamente 802.11k y 802.11r.\n\nDurante la captura se observaron 3 intentos de steering, todos fallidos, y se detectaron bucles en las transiciones entre bandas. El tiempo promedio de transición fue de 52.44 segundos, con un máximo de 62.104 segundos, lo que indica un comportamiento problemático en el manejo de las bandas.\n\n## 2. ANÁLISIS TÉCNICO\n\n### Análisis de Protocolos de Roaming (802.11k/v/r)\nEl análisis de los protocolos de roaming revela que el cliente solo soporta 802.11v, pero no 802.11k ni 802.11r. Esto limita significativamente su capacidad para realizar transiciones de banda efectivas. Durante la captura, se registraron 3 intentos de steering, pero el cliente no respondió a ninguna solicitud BTM, lo que indica que está ignorando o rechazando estas solicitudes. Esto se evidencia en la falta de respuestas a las 3 solicitudes BTM enviadas.\n\n### Análisis de Transiciones de Banda\nSe registraron 3 intentos de transición de banda, todos fallidos:\n1. **Transición 1:** 2.4GHz a 5GHz - Estado: LOOP, Tiempo: 62.104s\n2. **Transición 2:** 5GHz a 2.4GHz - Estado: LOOP, Tiempo: 52.200s\n3. **Transición 3:** 2.4GHz a 5GHz - Estado: TIMEOUT, Tiempo: 43.016s\n\nLos bucles detectados indican que el cliente está atrapado en un ciclo de intentos de cambio de banda sin éxito, lo que sugiere una falta de cooperación con el AP para realizar un steering efectivo. La ausencia de transiciones exitosas resalta la ineficacia del mecanismo de steering implementado.\n\n### Estabilidad de Asociación\nEl análisis de la estabilidad de asociación muestra que no hubo eventos de desconexión forzada (Deauthentication o Disassociation), lo que es positivo. Sin embargo, la falta de transiciones efectivas y el comportamiento de bucle en las bandas indican que, aunque el cliente se mantuvo asociado, no está aprovechando adecuadamente las capacidades de la red.\n\n### Calidad de Red\nLos indicadores de calidad de red son positivos, con 0 retransmisiones TCP, 0 retries en WLAN y 0 errores DNS. Esto sugiere que, a pesar de los problemas de steering, la calidad de la conexión en términos de datos es adecuada.\n\n### Comportamiento del Cliente\nEl cliente analizado (b8:98:ad:ad:46:d0) muestra un comportamiento que indica una falta de soporte para los estándares de movilidad necesarios. La ausencia de 802.11k y 802.11r limita su capacidad para realizar decisiones informadas sobre el roaming, lo que contribuye a los fallos en el steering.\n\n## 3. CONCLUSIÓN FINAL\nLa auditoría de Band Steering ha resultado en un veredicto de FALLIDA debido a la falta de soporte para BTM, la ineficacia en las transiciones de banda y la ausencia de estándares KVR. Se recomienda revisar la configuración del cliente para habilitar los estándares faltantes y asegurar que el dispositivo pueda responder adecuadamente a las solicitudes de BTM. Además, es crucial investigar el flujo completo de steering para identificar posibles mejoras en la implementación del mecanismo de steering.",
    "raw_stats": {
        "total_packets": 15,
        "total_tcp_packets": 0,
        "total_wlan_packets": 15,
        "approx_total_bytes": 0,
        "diagnostics": {
            "tcp_retransmissions": 0,
            "wlan_retries": 0,
            "dns_errors": 0,
            "steering_events_count": 9,
            "unique_bssid_count": 2,
            "bssid_info": {
                "00:19:c6:51:00:24": {
                    "band": "2.4GHz",
                    "ssid": "483336303150",
                    "frequency": "2462"
                },
                "00:19:c6:51:00:25": {
                    "band": "5GHz",
                    "ssid": "483336303150",
                    "frequency": "5180"
                }
            },
            "client_mac": "b8:98:ad:ad:46:d0",
            "capture_quality": "VALIDA - Steering fallido pero analizable",
            "band_counters": {
                "beacon_24": 0,
                "beacon_5": 0,
                "probe_req": 0,
                "probe_resp_24": 0,
                "probe_resp_5": 0,
                "data_24": 0,
                "data_5": 0
            }
        },
        "steering_analysis": {
            "transitions": [
                {
                    "client": "b8:98:ad:ad:46:d0",
                    "type": "assisted",
                    "deauth_time": null,
                    "reassoc_time": 1724398517.076488,
                    "transition_time": 62.10376000404358,
                    "from_bssid": "00:19:c6:51:00:24",
                    "to_bssid": "00:19:c6:51:00:25",
                    "from_band": "2.4GHz",
                    "to_band": "5GHz",
                    "is_band_change": true,
                    "reason_code": null,
                    "status": "LOOP",
                    "returned_to_original": true
                },
                {
                    "client": "b8:98:ad:ad:46:d0",
                    "type": "assisted",
                    "deauth_time": null,
                    "reassoc_time": 1724398569.278717,
                    "transition_time": 52.200485944747925,
                    "from_bssid": "00:19:c6:51:00:25",
                    "to_bssid": "00:19:c6:51:00:24",
                    "from_band": "5GHz",
                    "to_band": "2.4GHz",
                    "is_band_change": true,
                    "reason_code": null,
                    "status": "LOOP",
                    "returned_to_original": true
                },
                {
                    "client": "b8:98:ad:ad:46:d0",
                    "type": "assisted",
                    "deauth_time": null,
                    "reassoc_time": 1724398612.297764,
                    "transition_time": 43.01604104042053,
                    "from_bssid": "00:19:c6:51:00:24",
                    "to_bssid": "00:19:c6:51:00:25",
                    "from_band": "2.4GHz",
                    "to_band": "5GHz",
                    "is_band_change": true,
                    "reason_code": null,
                    "status": "TIMEOUT",
                    "returned_to_original": false
                }
            ],
            "steering_attempts": 3,
            "successful_transitions": 0,
            "failed_transitions": 3,
            "loop_detected": true,
            "avg_transition_time": 52.44,
            "max_transition_time": 62.104,
            "transition_times": [
                62.10376000404358,
                52.200485944747925,
                43.01604104042053
            ],
            "verdict": "FAILED_LOOP",
            "clients_analyzed": 1,
            "preventive_steering": false
        },
        "steering_events": [
            {
                "timestamp": 1724398454.957609,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:24",
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "483336303150",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-60"
            },
            {
                "timestamp": 1724398454.969727,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "b8:98:ad:ad:46:d0",
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-82"
            },
            {
                "timestamp": 1724398454.972728,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "b8:98:ad:ad:46:d0",
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-82"
            },
            {
                "timestamp": 1724398517.076488,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:25",
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-68"
            },
            {
                "timestamp": 1724398517.078231,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:25",
                "da": "b8:98:ad:ad:46:d0",
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-18"
            },
            {
                "timestamp": 1724398569.278717,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "b8:98:ad:ad:46:d0",
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-68"
            },
            {
                "timestamp": 1724398569.281723,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "b8:98:ad:ad:46:d0",
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-68"
            },
            {
                "timestamp": 1724398612.297764,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:25",
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-82"
            },
            {
                "timestamp": 1724398612.299493,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:25",
                "da": "b8:98:ad:ad:46:d0",
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-18"
            }
        ],
        "signal_samples": [
            {
                "timestamp": 1724398454.940115,
                "rssi": -90,
                "band": "2.4GHz",
                "frequency": 2462,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:24"
            },
            {
                "timestamp": 1724398454.957609,
                "rssi": -60,
                "band": "2.4GHz",
                "frequency": 2462,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:24"
            },
            {
                "timestamp": 1724398517.061374,
                "rssi": -68,
                "band": "5GHz",
                "frequency": 5180,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:25"
            },
            {
                "timestamp": 1724398517.076488,
                "rssi": -68,
                "band": "5GHz",
                "frequency": 5180,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:25"
            },
            {
                "timestamp": 1724398612.283654,
                "rssi": -80,
                "band": "5GHz",
                "frequency": 5180,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:25"
            },
            {
                "timestamp": 1724398612.297764,
                "rssi": -82,
                "band": "5GHz",
                "frequency": 5180,
                "sa": "b8:98:ad:ad:46:d0",
                "da": "00:19:c6:51:00:25"
            }
        ],
        "top_protocols": [
            [
                "radiotap",
                15
            ],
            [
                "wlan_radio",
                15
            ],
            [
                "wlan",
                15
            ]
        ],
        "top_sources": [],
        "top_destinations": []
    },
    "fragments": []
}