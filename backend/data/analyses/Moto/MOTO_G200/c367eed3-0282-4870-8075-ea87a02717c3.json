{
    "analysis_id": "c367eed3-0282-4870-8075-ea87a02717c3",
    "filename": "84923dba-d42e-495e-a9e8-32d08028a43a_15.MOTO G200.pcapng",
    "analysis_timestamp": "2026-01-23T09:07:20.141438",
    "total_packets": 15,
    "wlan_packets": 15,
    "analysis_duration_ms": 0,
    "devices": [
        {
            "mac_address": "b8:98:ad:ad:46:d0",
            "oui": "b8:98:ad",
            "vendor": "Moto",
            "device_model": "MOTO G200",
            "device_category": "mobile_device",
            "is_virtual": false,
            "confidence_score": 1.0
        }
    ],
    "btm_events": [],
    "transitions": [],
    "btm_requests": 1,
    "btm_responses": 0,
    "btm_success_rate": 0.0,
    "successful_transitions": 0,
    "failed_transitions": 0,
    "loops_detected": false,
    "kvr_support": {
        "k_support": false,
        "v_support": true,
        "r_support": false,
        "compliance_score": 0.3333333333333333
    },
    "compliance_checks": [
        {
            "check_name": "Soporte BTM (802.11v)",
            "description": "El dispositivo debe demostrar soporte activo de BSS Transition Management",
            "category": "btm",
            "passed": false,
            "severity": "high",
            "score": 0.0,
            "details": "Request: 1, Response: 0",
            "recommendation": "El cliente ignora o rechaza solicitudes BTM. Revisar códigos de estado."
        },
        {
            "check_name": "Asociación y Reasociación",
            "description": "Verifica ciclos completos de asociación y reasociación",
            "category": "association",
            "passed": true,
            "severity": "medium",
            "score": 0.5,
            "details": "Assoc: 0/0, Reassoc: 3/6\nDisassoc: 0, Deauth: 0",
            "recommendation": "El dispositivo se asocia pero no demuestra cooperación con protocolos inteligentes (BTM)."
        },
        {
            "check_name": "Steering Efectivo",
            "description": "Se deben realizar cambios de banda efectivos (2.4 -> 5GHz)",
            "category": "performance",
            "passed": false,
            "severity": "high",
            "score": 0.0,
            "details": "Cambios de banda: 0",
            "recommendation": "Ajustar umbrales de RSSI para forzar steering"
        },
        {
            "check_name": "Estándares KVR",
            "description": "Soporte de estándares de movilidad (Mínimo 2 de 3: k, v, r)",
            "category": "kvr",
            "passed": false,
            "severity": "medium",
            "score": 0.3333333333333333,
            "details": "k=False, v=True, r=False",
            "recommendation": "Se recomienda habilitar el estándar faltante para roaming óptimo"
        }
    ],
    "overall_compliance_score": 0.20833333333333331,
    "verdict": "FAILED",
    "analysis_text": "# INFORME TÉCNICO DE AUDITORÍA DE BAND STEERING\n\n## 1. RESUMEN EJECUTIVO (EVIDENCIA CLAVE)\nEl veredicto de la auditoría es **FAILED** debido a los siguientes checks críticos que fallaron:\n- **Soporte BTM (802.11v)**: El cliente ignora o rechaza solicitudes BTM, evidenciado por 1 Request y 0 Responses.\n- **Steering Efectivo**: No se realizaron cambios de banda efectivos, con un total de 0 cambios de banda detectados.\n- **Estándares KVR**: Se detectó soporte para 802.11v, pero faltan los estándares 802.11k y 802.11r, lo que limita el roaming óptimo.\n\n## 2. ANÁLISIS BTM Y KVR (802.11k/v/r)\n- **Protocolos Detectados**: Se identificó el estándar 802.11v, pero no se detectaron 802.11k ni 802.11r.\n- **Intercambio BTM**: No hubo eventos BTM efectivos, con 1 Request y 0 Responses, lo que indica que el cliente no está participando activamente en el manejo de transiciones de banda.\n- **Interpretación**: El cliente no soporta roaming inteligente de manera efectiva, lo que afecta la calidad de la conexión y la experiencia del usuario.\n\n### IMPORTANTE\nLa falta de soporte para los estándares 802.11k y 802.11r es crítica, ya que estos son esenciales para un roaming eficiente y una gestión de la red más efectiva.\n\n## 3. DETALLE DE TRANSICIONES\nSe observó una transición asistida desde 2.4GHz a 5GHz, pero esta resultó en un **TIMEOUT** con un tiempo promedio de transición de 62.119 segundos. No se detectaron bucles, lo que es positivo, pero la falta de transiciones exitosas indica que el steering no fue efectivo.\n\nEn resumen, la auditoría revela deficiencias significativas en la implementación de Band Steering, lo que requiere atención inmediata para mejorar la experiencia del usuario y la eficiencia de la red. Se recomienda ajustar los umbrales de RSSI y habilitar los estándares faltantes para optimizar el rendimiento de la red.",
    "raw_stats": {
        "total_packets": 15,
        "total_tcp_packets": 0,
        "total_wlan_packets": 15,
        "approx_total_bytes": 0,
        "diagnostics": {
            "tcp_retransmissions": 0,
            "wlan_retries": 0,
            "dns_errors": 0,
            "steering_events_count": 9,
            "unique_bssid_count": 2,
            "bssid_info": {
                "00:19:c6:51:00:24": {
                    "band": "2.4GHz",
                    "ssid": "483336303150",
                    "frequency": "2462"
                },
                "00:19:c6:51:00:25": {
                    "band": "5GHz",
                    "ssid": "483336303150",
                    "frequency": "5180"
                }
            },
            "client_mac": "b8:98:ad:ad:46:d0",
            "capture_quality": "INSUFICIENTE - Eventos inconclusos",
            "band_counters": {
                "beacon_24": 0,
                "beacon_5": 0,
                "probe_req": 0,
                "probe_resp_24": 0,
                "probe_resp_5": 0,
                "data_24": 0,
                "data_5": 0
            }
        },
        "steering_analysis": {
            "transitions": [
                {
                    "client": "b8:98:ad:ad:46:d0",
                    "type": "assisted",
                    "deauth_time": null,
                    "reassoc_time": 1724398517.076488,
                    "transition_time": 62.118879079818726,
                    "from_bssid": "00:19:c6:51:00:24",
                    "to_bssid": "00:19:c6:51:00:25",
                    "from_band": "2.4GHz",
                    "to_band": "5GHz",
                    "is_band_change": true,
                    "reason_code": null,
                    "status": "TIMEOUT",
                    "returned_to_original": false
                }
            ],
            "steering_attempts": 1,
            "successful_transitions": 0,
            "failed_transitions": 0,
            "loop_detected": false,
            "avg_transition_time": 62.119,
            "max_transition_time": 62.119,
            "transition_times": [
                62.118879079818726
            ],
            "verdict": "FAILED",
            "clients_analyzed": 3,
            "preventive_steering": false
        },
        "steering_events": [
            {
                "timestamp": 1724398454.957609,
                "type": "Reassociation Request",
                "subtype": 2,
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "483336303150",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1724398454.969727,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724398454.972728,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724398517.076488,
                "type": "Reassociation Request",
                "subtype": 2,
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1724398517.078231,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724398569.278717,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724398569.281723,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1724398612.297764,
                "type": "Reassociation Request",
                "subtype": 2,
                "client_mac": "b8:98:ad:ad:46:d0",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1724398612.299493,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            }
        ],
        "top_protocols": [
            [
                "radiotap",
                15
            ],
            [
                "wlan_radio",
                15
            ],
            [
                "wlan",
                15
            ]
        ],
        "top_sources": [],
        "top_destinations": []
    },
    "fragments": []
}