{
    "analysis_id": "618b3bfa-194a-4960-a1bf-a81dffc745aa",
    "filename": "MOTO G7 .pcapng",
    "analysis_timestamp": "2026-01-23T12:19:00.402040",
    "total_packets": 20,
    "wlan_packets": 20,
    "analysis_duration_ms": 0,
    "devices": [
        {
            "mac_address": "12:27:9e:88:3a:96",
            "oui": "12:27:9e",
            "vendor": "Moto",
            "device_model": "MOTO G7",
            "device_category": "mobile_device",
            "is_virtual": true,
            "confidence_score": 1.0
        }
    ],
    "btm_events": [],
    "transitions": [],
    "btm_requests": 2,
    "btm_responses": 0,
    "btm_success_rate": 0.0,
    "successful_transitions": 0,
    "failed_transitions": 1,
    "loops_detected": true,
    "kvr_support": {
        "k_support": false,
        "v_support": true,
        "r_support": false
    },
    "compliance_checks": [
        {
            "check_name": "Soporte BTM (802.11v)",
            "description": "El dispositivo debe demostrar soporte activo de BSS Transition Management",
            "category": "btm",
            "passed": false,
            "severity": "high",
            "details": "Request: 2, Response: 0",
            "recommendation": "El cliente ignora o rechaza solicitudes BTM. Revisar códigos de estado."
        },
        {
            "check_name": "Asociación y Reasociación",
            "description": "Verifica ciclos completos de asociación y reasociación",
            "category": "association",
            "passed": false,
            "severity": "medium",
            "details": "Assoc: 1/1, Reassoc: 3/4\nDisassoc: 0, Deauth: 1",
            "recommendation": "Prueba FALLIDA: Se detectaron 1 Deauth y 0 Disassoc DIRIGIDOS al cliente, indicando inestabilidad forzada."
        },
        {
            "check_name": "Steering Efectivo",
            "description": "Se deben realizar cambios de banda efectivos (2.4 -> 5GHz)",
            "category": "performance",
            "passed": false,
            "severity": "high",
            "details": "Cambios de banda: 0",
            "recommendation": "Ajustar umbrales de RSSI para forzar steering"
        },
        {
            "check_name": "Estándares KVR",
            "description": "Soporte de estándares de movilidad (Mínimo 2 de 3: k, v, r)",
            "category": "kvr",
            "passed": false,
            "severity": "medium",
            "details": "k=False, v=True, r=False",
            "recommendation": "Se recomienda habilitar el estándar faltante para roaming óptimo"
        }
    ],
    "verdict": "FAILED",
    "analysis_text": "# INFORME TÉCNICO DE AUDITORÍA DE BAND STEERING\n\n**Archivo Analizado:** MOTO G7 .pcapng  \n**Paquetes WLAN Analizados:** 20  \n**Eventos 802.11 Capturados:** 10  \n**Calidad de Captura:** VÁLIDA - Steering fallido pero analizable  \n\n---\n\n## 1. RESUMEN EJECUTIVO\n\n**Veredicto Final AIDLC:** FAILED\n\nLa auditoría de Band Steering ha resultado en un veredicto de FALLIDO debido a los siguientes checks que no se cumplieron:\n\n- **Soporte BTM (802.11v):** El cliente no demostró soporte activo para BSS Transition Management, con 2 solicitudes y 0 respuestas.\n- **Asociación y Reasociación:** Se detectó 1 evento de Deauthentication, lo que indica inestabilidad en la conexión.\n- **Steering Efectivo:** No se realizaron cambios de banda efectivos, con 0 transiciones exitosas de 2.4GHz a 5GHz.\n- **Estándares KVR:** El cliente no soporta 802.11k y 802.11r, limitando su capacidad de roaming.\n\nDurante la captura, se registraron 2 intentos de steering, de los cuales ninguno fue exitoso. Se detectaron bucles en las transiciones, con un tiempo promedio de transición de 64.683 segundos y un tiempo máximo de 78.459 segundos.\n\n---\n\n## 2. ANÁLISIS TÉCNICO\n\n### Análisis de Protocolos de Roaming (802.11k/v/r)\n\n- **Soporte BTM (802.11v): FALLÓ**\n  - **Evidencia:** Se registraron 2 solicitudes de BTM, pero no se recibió ninguna respuesta. Esto indica que el cliente está ignorando o rechazando las solicitudes de gestión de transición de BSS, lo que limita su capacidad para realizar un roaming eficiente.\n  - **Recomendación:** Es crucial revisar los códigos de estado de las solicitudes BTM para entender por qué el cliente no está respondiendo.\n\n- **Estándares KVR: FALLÓ**\n  - **Evidencia:** El cliente soporta 802.11v, pero no 802.11k ni 802.11r. Esto significa que no puede recibir informes de vecinos ni realizar transiciones rápidas, lo que afecta negativamente su capacidad de roaming.\n  - **Recomendación:** Habilitar el soporte para 802.11k y 802.11r para mejorar la experiencia de roaming.\n\n### Análisis de Transiciones de Banda\n\n- **Transiciones Detectadas:**\n  - Se registraron 2 intentos de steering, pero solo 1 fue fallido y 0 exitosos. Esto indica que el cliente no está cambiando de banda de manera efectiva.\n  - **Tipo de Steering:** Se observó un intento de steering agresivo mediante un evento de Deauthentication, que resultó en un bucle, ya que el cliente permaneció en la misma banda (5GHz).\n  - **Tiempo de Transición:** El tiempo promedio de transición fue de 64.683 segundos, con un máximo de 78.459 segundos, lo que sugiere que el cliente está experimentando demoras significativas en la transición.\n\n### Estabilidad de Asociación\n\n- **Asociación y Reasociación: FALLÓ**\n  - **Evidencia:** Se registró 1 evento de Deauthentication y 3 de Reassociation, con 1 asociación exitosa. La presencia de un evento de Deauthentication indica que el cliente fue forzado a desconectarse, lo que afecta la estabilidad de la conexión.\n  - **Impacto:** Esta inestabilidad puede llevar a una experiencia de usuario deficiente, ya que el cliente puede experimentar desconexiones inesperadas.\n\n### Calidad de Red\n\n- **Indicadores de Red:**\n  - **TCP Retransmissions:** 0\n  - **WLAN Retries:** 0\n  - **DNS Errors:** 0\n  - Aunque no se registraron errores en la red, la falta de transiciones efectivas y el soporte limitado para BTM y estándares KVR son preocupantes.\n\n### Comportamiento del Cliente\n\n- **Capacidades Detectadas:**\n  - El cliente analizado (MOTO G7) no está utilizando adecuadamente las capacidades de roaming disponibles debido a la falta de soporte para los estándares necesarios.\n  - **Preferencias de Banda:** El cliente parece estar atado a la banda de 5GHz, lo que limita su capacidad de aprovechar la banda de 2.4GHz cuando es necesario.\n\n---\n\n## 3. CONCLUSIÓN FINAL\n\nLa auditoría de Band Steering ha resultado en un veredicto de FALLIDO debido a la falta de soporte para BTM, problemas de asociación y re-asociación, la ineficacia en el steering y la ausencia de estándares KVR. Se recomienda encarecidamente revisar la configuración del cliente y habilitar los estándares necesarios para mejorar la experiencia de roaming y la estabilidad de la conexión. La implementación de ajustes en los umbrales de RSSI también podría ser beneficiosa para forzar un steering más efectivo.",
    "raw_stats": {
        "total_packets": 20,
        "total_tcp_packets": 0,
        "total_wlan_packets": 20,
        "approx_total_bytes": 0,
        "diagnostics": {
            "tcp_retransmissions": 0,
            "wlan_retries": 0,
            "dns_errors": 0,
            "steering_events_count": 10,
            "unique_bssid_count": 2,
            "bssid_info": {
                "f8:79:28:56:f3:d5": {
                    "band": "5GHz",
                    "ssid": "5a54455f5031",
                    "frequency": "5180"
                },
                "f8:79:28:86:f3:d4": {
                    "band": "2.4GHz",
                    "ssid": "5a54455f5031",
                    "frequency": "2462"
                }
            },
            "client_mac": "60:1d:91:60:fe:f3",
            "capture_quality": "VALIDA - Steering fallido pero analizable",
            "band_counters": {
                "beacon_24": 0,
                "beacon_5": 0,
                "probe_req": 0,
                "probe_resp_24": 0,
                "probe_resp_5": 0,
                "data_24": 0,
                "data_5": 0
            }
        },
        "steering_analysis": {
            "transitions": [
                {
                    "client": "f8:79:28:56:f3:d5",
                    "type": "aggressive",
                    "deauth_time": 1726583174.389026,
                    "reassoc_time": 1726583252.848487,
                    "transition_time": 78.45946097373962,
                    "from_bssid": "f8:79:28:56:f3:d5",
                    "to_bssid": "f8:79:28:56:f3:d5",
                    "from_band": "5GHz",
                    "to_band": "5GHz",
                    "is_band_change": false,
                    "reason_code": "0x0002",
                    "status": "LOOP",
                    "returned_to_original": true
                },
                {
                    "client": "60:1d:91:60:fe:f3",
                    "type": "assisted",
                    "deauth_time": null,
                    "reassoc_time": 1726583350.362944,
                    "transition_time": 50.90698194503784,
                    "from_bssid": "f8:79:28:86:f3:d4",
                    "to_bssid": "f8:79:28:56:f3:d5",
                    "from_band": "2.4GHz",
                    "to_band": "5GHz",
                    "is_band_change": true,
                    "reason_code": null,
                    "status": "TIMEOUT",
                    "returned_to_original": false
                }
            ],
            "steering_attempts": 2,
            "successful_transitions": 0,
            "failed_transitions": 1,
            "loop_detected": true,
            "avg_transition_time": 64.683,
            "max_transition_time": 78.459,
            "transition_times": [
                78.45946097373962,
                50.90698194503784
            ],
            "verdict": "FAILED_LOOP",
            "clients_analyzed": 4,
            "preventive_steering": false
        },
        "steering_events": [
            {
                "timestamp": 1726583171.368728,
                "type": "Association Request",
                "subtype": 0,
                "sa": "12:27:9e:88:3a:96",
                "da": "f8:79:28:56:f3:d5",
                "client_mac": "12:27:9e:88:3a:96",
                "bssid": "f8:79:28:56:f3:d5",
                "ssid": "5a54455f5031",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-90"
            },
            {
                "timestamp": 1726583171.370347,
                "type": "Association Response",
                "subtype": 1,
                "sa": "f8:79:28:56:f3:d5",
                "da": "12:27:9e:88:3a:96",
                "client_mac": "f8:79:28:56:f3:d5",
                "bssid": "f8:79:28:56:f3:d5",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-22"
            },
            {
                "timestamp": 1726583174.389026,
                "type": "Deauthentication",
                "subtype": 12,
                "sa": "f8:79:28:56:f3:d5",
                "da": "12:27:9e:88:3a:96",
                "client_mac": "f8:79:28:56:f3:d5",
                "bssid": "f8:79:28:56:f3:d5",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "0x0002",
                "assoc_status_code": "",
                "signal_strength": "-22"
            },
            {
                "timestamp": 1726583199.717333,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "60:1d:91:60:fe:f3",
                "da": "f8:79:28:86:f3:d4",
                "client_mac": "60:1d:91:60:fe:f3",
                "bssid": "f8:79:28:86:f3:d4",
                "ssid": "5a54455f5031",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-94"
            },
            {
                "timestamp": 1726583199.722583,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "f8:79:28:86:f3:d4",
                "da": "60:1d:91:60:fe:f3",
                "client_mac": "f8:79:28:86:f3:d4",
                "bssid": "f8:79:28:86:f3:d4",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-82"
            },
            {
                "timestamp": 1726583252.848487,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "f8:79:28:56:f3:d5",
                "da": "60:1d:91:60:fe:f3",
                "client_mac": "f8:79:28:56:f3:d5",
                "bssid": "f8:79:28:56:f3:d5",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-22"
            },
            {
                "timestamp": 1726583299.455962,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "60:1d:91:60:fe:f3",
                "da": "f8:79:28:86:f3:d4",
                "client_mac": "60:1d:91:60:fe:f3",
                "bssid": "f8:79:28:86:f3:d4",
                "ssid": "5a54455f5031",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-86"
            },
            {
                "timestamp": 1726583299.469834,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "f8:79:28:86:f3:d4",
                "da": "60:1d:91:60:fe:f3",
                "client_mac": "f8:79:28:86:f3:d4",
                "bssid": "f8:79:28:86:f3:d4",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-84"
            },
            {
                "timestamp": 1726583350.362944,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "60:1d:91:60:fe:f3",
                "da": "f8:79:28:56:f3:d5",
                "client_mac": "60:1d:91:60:fe:f3",
                "bssid": "f8:79:28:56:f3:d5",
                "ssid": "5a54455f5031",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-78"
            },
            {
                "timestamp": 1726583350.365272,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "f8:79:28:56:f3:d5",
                "da": "60:1d:91:60:fe:f3",
                "client_mac": "f8:79:28:56:f3:d5",
                "bssid": "f8:79:28:56:f3:d5",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-22"
            }
        ],
        "top_protocols": [
            [
                "radiotap",
                20
            ],
            [
                "wlan_radio",
                20
            ],
            [
                "wlan",
                20
            ]
        ],
        "top_sources": [],
        "top_destinations": []
    },
    "fragments": []
}