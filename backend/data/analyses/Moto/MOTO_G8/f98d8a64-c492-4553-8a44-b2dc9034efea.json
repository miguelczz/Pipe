{
    "analysis_id": "f98d8a64-c492-4553-8a44-b2dc9034efea",
    "filename": "MOTO G8.pcapng",
    "analysis_timestamp": "2026-01-27T10:13:17.895831",
    "total_packets": 18,
    "wlan_packets": 18,
    "analysis_duration_ms": 0,
    "devices": [
        {
            "mac_address": "24:46:c8:4d:1d:a6",
            "oui": "24:46:c8",
            "vendor": "Moto",
            "device_model": "MOTO G8",
            "device_category": "mobile_device",
            "is_virtual": false,
            "confidence_score": 1.0
        }
    ],
    "btm_events": [],
    "transitions": [
        {
            "client_mac": "00:19:c6:51:00:24",
            "steering_type": "unknown",
            "start_time": 1724378265.100936,
            "end_time": 1724378265.100936,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:24",
            "to_bssid": "00:19:c6:51:00:24",
            "from_band": "2.4GHz",
            "to_band": "2.4GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        },
        {
            "client_mac": "00:19:c6:51:00:24",
            "steering_type": "unknown",
            "start_time": 1724378295.614963,
            "end_time": 1724378295.614963,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:24",
            "to_bssid": "00:19:c6:51:00:24",
            "from_band": "2.4GHz",
            "to_band": "2.4GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        },
        {
            "client_mac": "00:19:c6:51:00:25",
            "steering_type": "unknown",
            "start_time": 1724378449.279193,
            "end_time": 1724378449.279193,
            "duration": 0.0,
            "from_bssid": "00:19:c6:51:00:25",
            "to_bssid": "00:19:c6:51:00:25",
            "from_band": "5GHz",
            "to_band": "5GHz",
            "is_successful": true,
            "is_band_change": false,
            "returned_to_original": false,
            "btm_status_code": null,
            "failure_reason": null
        }
    ],
    "signal_samples": [
        {
            "timestamp": 1724378265.074997,
            "rssi": -90,
            "band": "2.4GHz",
            "frequency": 2462
        },
        {
            "timestamp": 1724378265.082592,
            "rssi": -90,
            "band": "2.4GHz",
            "frequency": 2462
        },
        {
            "timestamp": 1724378265.092818,
            "rssi": -92,
            "band": "2.4GHz",
            "frequency": 2462
        },
        {
            "timestamp": 1724378295.589975,
            "rssi": -86,
            "band": "2.4GHz",
            "frequency": 2462
        },
        {
            "timestamp": 1724378295.599729,
            "rssi": -86,
            "band": "2.4GHz",
            "frequency": 2462
        },
        {
            "timestamp": 1724378449.268822,
            "rssi": -36,
            "band": "5GHz",
            "frequency": 5180
        },
        {
            "timestamp": 1724378449.277017,
            "rssi": -34,
            "band": "5GHz",
            "frequency": 5180
        },
        {
            "timestamp": 1724378582.440671,
            "rssi": -24,
            "band": "5GHz",
            "frequency": 5180
        }
    ],
    "btm_requests": 1,
    "btm_responses": 0,
    "btm_success_rate": 0.0,
    "successful_transitions": 0,
    "failed_transitions": 1,
    "loops_detected": false,
    "kvr_support": {
        "k_support": false,
        "v_support": true,
        "r_support": false
    },
    "compliance_checks": [
        {
            "check_name": "Soporte BTM (802.11v)",
            "description": "El dispositivo debe demostrar soporte activo de BSS Transition Management",
            "category": "btm",
            "passed": false,
            "severity": "high",
            "details": "Request: 1, Response: 0",
            "recommendation": "El cliente ignora o rechaza solicitudes BTM. Revisar códigos de estado."
        },
        {
            "check_name": "Asociación y Reasociación",
            "description": "Verifica ciclos completos de asociación y reasociación",
            "category": "association",
            "passed": true,
            "severity": "medium",
            "details": "Assoc: 0/0, Reassoc: 3/3\nDisassoc: 0, Deauth: 0",
            "recommendation": null
        },
        {
            "check_name": "Steering Efectivo",
            "description": "Se deben realizar cambios de banda estables (2.4 -> 5GHz)",
            "category": "performance",
            "passed": false,
            "severity": "high",
            "details": "Cambios detectados: 0",
            "recommendation": "No se detectaron transiciones de banda efectivas. Verificar que la captura contenga el flujo completo de steering."
        },
        {
            "check_name": "Estándares KVR",
            "description": "Soporte de estándares de movilidad (Mínimo 2 de 3: k, v, r)",
            "category": "kvr",
            "passed": false,
            "severity": "medium",
            "details": "k=False, v=True, r=False",
            "recommendation": "Se recomienda habilitar el estándar faltante para roaming óptimo"
        }
    ],
    "verdict": "FAILED",
    "analysis_text": "# INFORME TÉCNICO DE AUDITORÍA DE BAND STEERING\n\n## 1. RESUMEN EJECUTIVO\n**Veredicto Final:** FALLIDA\n\nLa auditoría de Band Steering ha resultado en un veredicto FALLIDO debido a las siguientes causas:\n\n- **Soporte BTM (802.11v): FALLÓ** - El cliente no demostró soporte activo para BSS Transition Management, con 1 solicitud y 0 respuestas.\n- **Steering Efectivo: FALLÓ** - No se detectaron transiciones de banda efectivas, con 0 cambios de 2.4GHz a 5GHz.\n- **Estándares KVR: FALLÓ** - El cliente solo soporta 802.11v, careciendo de 802.11k y 802.11r, lo que limita su capacidad de roaming.\n\nDurante la captura se analizaron 18 paquetes WLAN, de los cuales se registraron 8 eventos 802.11. Se observó un intento de steering que resultó en una transición fallida, con un tiempo promedio de transición de 153.677 segundos.\n\n## 2. ANÁLISIS TÉCNICO\n\n### Análisis de Protocolos de Roaming (802.11k/v/r)\n- **Soporte BTM (802.11v): FALLÓ**\n  - Se detectó 1 solicitud de BTM, pero no hubo respuestas, lo que indica que el cliente ignora o rechaza las solicitudes de gestión de transición de BSS. Esto es crítico, ya que el soporte de BTM es esencial para facilitar el steering efectivo entre bandas.\n  \n- **Estándares KVR: FALLÓ**\n  - El cliente solo soporta 802.11v, mientras que no se detectó soporte para 802.11k (Neighbor Reports) ni 802.11r (Fast Transition). La falta de estos estándares limita la capacidad del cliente para realizar decisiones informadas sobre el roaming, lo que afecta negativamente la experiencia del usuario.\n\n### Análisis de Transiciones de Banda\n- **Steering Efectivo: FALLÓ**\n  - Se registró un intento de transición de 2.4GHz a 5GHz que resultó en un estado de TIMEOUT. No se detectaron transiciones exitosas, lo que indica que el cliente no pudo cambiar de banda a pesar de que el AP estaba disponible en ambas frecuencias. Esto sugiere que el mecanismo de steering no está funcionando adecuadamente.\n\n### Estabilidad de Asociación\n- **Asociación y Reasociación: PASÓ**\n  - Se registraron 3 re-asociaciones exitosas sin eventos de desconexión forzada (Deauth) o desasociación (Disassoc). Esto indica que, aunque el cliente se mantuvo conectado, no pudo beneficiarse de un cambio de banda efectivo.\n\n### Calidad de Red\n- **Indicadores de Red:**\n  - No se detectaron retransmisiones TCP, WLAN retries ni errores DNS, lo que sugiere que la calidad de la red en términos de conectividad fue adecuada, pero no se tradujo en un steering efectivo.\n\n### Comportamiento del Cliente\n- **Insights sobre el dispositivo:**\n  - El cliente mostró un comportamiento pasivo en cuanto a la gestión de transiciones de banda, ignorando las solicitudes de BTM y sin realizar cambios efectivos de banda. Esto puede ser indicativo de limitaciones en el firmware del dispositivo o configuraciones que impiden el uso óptimo de las capacidades de roaming.\n\n## 3. CONCLUSIÓN FINAL\nLa auditoría de Band Steering ha resultado en un veredicto FALLIDO debido a la falta de soporte para BTM, la incapacidad de realizar transiciones efectivas entre bandas y la ausencia de estándares de movilidad críticos (802.11k y 802.11r). Se recomienda revisar la configuración del cliente y considerar actualizaciones de firmware para habilitar el soporte completo de los estándares necesarios para un rendimiento óptimo en entornos de red Wi-Fi.",
    "raw_stats": {
        "total_packets": 18,
        "total_tcp_packets": 0,
        "total_wlan_packets": 18,
        "approx_total_bytes": 0,
        "diagnostics": {
            "tcp_retransmissions": 0,
            "wlan_retries": 0,
            "dns_errors": 0,
            "steering_events_count": 8,
            "unique_bssid_count": 2,
            "bssid_info": {
                "00:19:c6:51:00:24": {
                    "band": "2.4GHz",
                    "ssid": "483336303150",
                    "frequency": "2462"
                },
                "00:19:c6:51:00:25": {
                    "band": "5GHz",
                    "ssid": "",
                    "frequency": "5180"
                }
            },
            "client_mac": "24:46:c8:4d:1d:a6",
            "capture_quality": "VALIDA - Steering fallido pero analizable",
            "band_counters": {
                "beacon_24": 0,
                "beacon_5": 0,
                "probe_req": 0,
                "probe_resp_24": 0,
                "probe_resp_5": 0,
                "data_24": 0,
                "data_5": 0
            }
        },
        "steering_analysis": {
            "transitions": [
                {
                    "client": "24:46:c8:4d:1d:a6",
                    "type": "assisted",
                    "deauth_time": null,
                    "reassoc_time": 1724378449.277017,
                    "transition_time": 153.67728805541992,
                    "from_bssid": "00:19:c6:51:00:24",
                    "to_bssid": "00:19:c6:51:00:25",
                    "from_band": "2.4GHz",
                    "to_band": "5GHz",
                    "is_band_change": true,
                    "reason_code": null,
                    "status": "TIMEOUT",
                    "returned_to_original": false
                }
            ],
            "steering_attempts": 1,
            "successful_transitions": 0,
            "failed_transitions": 1,
            "loop_detected": false,
            "avg_transition_time": 153.677,
            "max_transition_time": 153.677,
            "transition_times": [
                153.67728805541992
            ],
            "verdict": "FAILED",
            "clients_analyzed": 4,
            "preventive_steering": false
        },
        "steering_events": [
            {
                "timestamp": 1724378265.092818,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "24:46:c8:4d:1d:a6",
                "da": "00:19:c6:51:00:24",
                "client_mac": "24:46:c8:4d:1d:a6",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "483336303150",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-92"
            },
            {
                "timestamp": 1724378265.100936,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "24:46:c8:4d:1d:a6",
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-92"
            },
            {
                "timestamp": 1724378295.599729,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "24:46:c8:4d:1d:a6",
                "da": "00:19:c6:51:00:24",
                "client_mac": "24:46:c8:4d:1d:a6",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "483336303150",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-86"
            },
            {
                "timestamp": 1724378295.614963,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:24",
                "da": "24:46:c8:4d:1d:a6",
                "client_mac": "00:19:c6:51:00:24",
                "bssid": "00:19:c6:51:00:24",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2462",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-84"
            },
            {
                "timestamp": 1724378425.190884,
                "type": "Deauthentication",
                "subtype": 12,
                "sa": "38:80:df:12:f9:21",
                "da": "00:19:c6:51:00:25",
                "client_mac": "38:80:df:12:f9:21",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-44"
            },
            {
                "timestamp": 1724378449.277017,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "24:46:c8:4d:1d:a6",
                "da": "00:19:c6:51:00:25",
                "client_mac": "24:46:c8:4d:1d:a6",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-34"
            },
            {
                "timestamp": 1724378449.279193,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "00:19:c6:51:00:25",
                "da": "24:46:c8:4d:1d:a6",
                "client_mac": "00:19:c6:51:00:25",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000",
                "signal_strength": "-22"
            },
            {
                "timestamp": 1724378582.440671,
                "type": "Deauthentication",
                "subtype": 12,
                "sa": "24:46:c8:4d:1d:a6",
                "da": "00:19:c6:51:00:25",
                "client_mac": "24:46:c8:4d:1d:a6",
                "bssid": "00:19:c6:51:00:25",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "",
                "signal_strength": "-24"
            }
        ],
        "signal_samples": [
            {
                "timestamp": 1724378265.074997,
                "rssi": -90,
                "band": "2.4GHz",
                "frequency": 2462,
                "sa": "24:46:c8:4d:1d:a6",
                "da": "00:19:c6:51:00:24"
            },
            {
                "timestamp": 1724378265.082592,
                "rssi": -90,
                "band": "2.4GHz",
                "frequency": 2462,
                "sa": "24:46:c8:4d:1d:a6",
                "da": "00:19:c6:51:00:24"
            },
            {
                "timestamp": 1724378265.092818,
                "rssi": -92,
                "band": "2.4GHz",
                "frequency": 2462,
                "sa": "24:46:c8:4d:1d:a6",
                "da": "00:19:c6:51:00:24"
            },
            {
                "timestamp": 1724378295.589975,
                "rssi": -86,
                "band": "2.4GHz",
                "frequency": 2462,
                "sa": "24:46:c8:4d:1d:a6",
                "da": "00:19:c6:51:00:24"
            },
            {
                "timestamp": 1724378295.599729,
                "rssi": -86,
                "band": "2.4GHz",
                "frequency": 2462,
                "sa": "24:46:c8:4d:1d:a6",
                "da": "00:19:c6:51:00:24"
            },
            {
                "timestamp": 1724378449.268822,
                "rssi": -36,
                "band": "5GHz",
                "frequency": 5180,
                "sa": "24:46:c8:4d:1d:a6",
                "da": "00:19:c6:51:00:25"
            },
            {
                "timestamp": 1724378449.277017,
                "rssi": -34,
                "band": "5GHz",
                "frequency": 5180,
                "sa": "24:46:c8:4d:1d:a6",
                "da": "00:19:c6:51:00:25"
            },
            {
                "timestamp": 1724378582.440671,
                "rssi": -24,
                "band": "5GHz",
                "frequency": 5180,
                "sa": "24:46:c8:4d:1d:a6",
                "da": "00:19:c6:51:00:25"
            }
        ],
        "top_protocols": [
            [
                "radiotap",
                18
            ],
            [
                "wlan_radio",
                18
            ],
            [
                "wlan",
                18
            ],
            [
                "data",
                2
            ]
        ],
        "top_sources": [],
        "top_destinations": []
    },
    "fragments": []
}