{
    "analysis_id": "c7863c63-07dd-46a0-9976-d4f102cfa713",
    "filename": "c9e84411-3da8-46c1-846f-3d5a106c9511_3.MOTO G8.pcapng",
    "analysis_timestamp": "2026-01-22T13:37:59.966697",
    "total_packets": 657301,
    "wlan_packets": 657282,
    "analysis_duration_ms": 0,
    "devices": [
        {
            "mac_address": "68:a3:c4:fc:ad:96",
            "oui": "68:a3:c4",
            "vendor": "Moto",
            "device_model": "MOTO G8",
            "device_category": "mobile_device",
            "is_virtual": false,
            "confidence_score": 1.0
        }
    ],
    "btm_events": [],
    "transitions": [],
    "btm_requests": 10,
    "btm_responses": 1,
    "btm_success_rate": 0.1,
    "successful_transitions": 1,
    "failed_transitions": 7,
    "loops_detected": true,
    "kvr_support": {
        "k_support": true,
        "v_support": true,
        "r_support": false,
        "compliance_score": 0.6666666666666666
    },
    "compliance_checks": [
        {
            "check_name": "Soporte BTM (802.11v)",
            "description": "El dispositivo debe demostrar soporte activo de BSS Transition Management",
            "category": "btm",
            "passed": true,
            "severity": "high",
            "score": 1.0,
            "details": "Requests: 10, Responses: 1",
            "recommendation": null
        },
        {
            "check_name": "Asociación Exitosa",
            "description": "No deben existir fallos de asociación (Status != 0)",
            "category": "association",
            "passed": true,
            "severity": "medium",
            "score": 1.0,
            "details": "Fallos detectados: 0",
            "recommendation": null
        },
        {
            "check_name": "Steering Efectivo",
            "description": "Se deben realizar cambios de banda efectivos (2.4 -> 5GHz)",
            "category": "performance",
            "passed": true,
            "severity": "high",
            "score": 1.0,
            "details": "Cambios de banda: 1",
            "recommendation": null
        },
        {
            "check_name": "Estándares KVR",
            "description": "Soporte de estándares de movilidad (Mínimo 2 de 3: k, v, r)",
            "category": "kvr",
            "passed": true,
            "severity": "medium",
            "score": 0.6666666666666666,
            "details": "k=True, v=True, r=False",
            "recommendation": null
        }
    ],
    "overall_compliance_score": 0.9166666666666666,
    "verdict": "SUCCESS",
    "analysis_text": "### 1. RESUMEN EJECUTIVO (EVIDENCIA CLAVE)\nEl análisis de la captura de Wireshark revela que, a pesar de que el veredicto preliminar indica un estado \"ACCEPTABLE\", se identificaron transiciones exitosas y fallidas. Se registró una transición exitosa de 2.4GHz a 5GHz, respaldada por un BTM Response con un Status Code 0 (Accept), lo que indica que el cliente cooperó con el proceso de Band Steering. Sin embargo, también se detectaron 7 transiciones fallidas y bucles entre puntos de acceso, lo que sugiere que el proceso de steering no fue completamente eficiente. El tiempo promedio de transición fue de 24.649 segundos, con un máximo de 64.11 segundos, lo que indica que las transiciones no fueron rápidas ni fluidas.\n\n### 2. ANÁLISIS BTM Y KVR (802.11k/v/r)\nSe detectaron los siguientes protocolos de roaming:\n- **802.11k:** Neighbor Reports\n- **802.11v:** BTM/WNM\n\nEl intercambio de BTM mostró un Request y un Response, con un Status Code de 0 (Accept), lo que confirma que el cliente es capaz de cooperar con la gestión de la red. Esto indica que el cliente tiene soporte para las funcionalidades avanzadas de gestión de red, lo que es un aspecto positivo. Sin embargo, la presencia de múltiples intentos fallidos y bucles sugiere que, aunque el cliente es inteligente y puede recibir instrucciones, la implementación del steering no fue óptima.\n\n### 3. DETALLE DE TRANSICIONES\nSe registraron un total de 10 intentos de steering, de los cuales solo 1 fue exitoso. Las transiciones exitosas se realizaron con un tiempo promedio de 24.649 segundos, lo que es considerablemente alto, especialmente en un entorno donde se espera que las transiciones sean rápidas. Las transiciones fallidas, que suman 7, indican problemas en la gestión del steering, y los bucles detectados sugieren que el cliente no pudo estabilizarse en una banda adecuada, lo que es un claro indicativo de un fallo en el proceso de steering.\n\nEn conclusión, aunque se logró una transición exitosa, la alta tasa de fallos y la presencia de bucles indican que el band steering no está funcionando de manera óptima. Por lo tanto, el veredicto final debe considerar estos aspectos negativos, a pesar de la cooperación del cliente y la existencia de un BTM Accept.",
    "fragments": []
}