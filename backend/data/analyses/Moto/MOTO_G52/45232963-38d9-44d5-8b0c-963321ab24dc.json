{
    "analysis_id": "45232963-38d9-44d5-8b0c-963321ab24dc",
    "filename": "8a9d11e5-a065-4421-b4e8-7decec835448_9.MOTO G52.pcapng",
    "analysis_timestamp": "2026-01-23T09:23:41.101113",
    "total_packets": 199162,
    "wlan_packets": 199162,
    "analysis_duration_ms": 0,
    "devices": [
        {
            "mac_address": "f4:2d:06:43:49:3f",
            "oui": "f4:2d:06",
            "vendor": "Moto",
            "device_model": "MOTO G52",
            "device_category": "mobile_device",
            "is_virtual": false,
            "confidence_score": 1.0
        }
    ],
    "btm_events": [],
    "transitions": [],
    "btm_requests": 1,
    "btm_responses": 1,
    "btm_success_rate": 1.0,
    "successful_transitions": 1,
    "failed_transitions": 0,
    "loops_detected": false,
    "kvr_support": {
        "k_support": true,
        "v_support": true,
        "r_support": false,
        "compliance_score": 0.6666666666666666
    },
    "compliance_checks": [
        {
            "check_name": "Soporte BTM (802.11v)",
            "description": "El dispositivo debe demostrar soporte activo de BSS Transition Management",
            "category": "btm",
            "passed": true,
            "severity": "high",
            "score": 1.0,
            "details": "Requests: 1, Responses: 1\nCode: 0 (Accept)",
            "recommendation": "Habilitar 802.11v"
        },
        {
            "check_name": "Asociación y Reasociación",
            "description": "Verifica ciclos completos de asociación y reasociación",
            "category": "association",
            "passed": true,
            "severity": "medium",
            "score": 1.0,
            "details": "Assoc: 0/0, Reassoc: 2/4\nDisassoc: 0, Deauth: 0",
            "recommendation": null
        },
        {
            "check_name": "Steering Efectivo",
            "description": "Se deben realizar cambios de banda efectivos (2.4 -> 5GHz)",
            "category": "performance",
            "passed": true,
            "severity": "high",
            "score": 1.0,
            "details": "Cambios de banda: 1",
            "recommendation": null
        },
        {
            "check_name": "Estándares KVR",
            "description": "Soporte de estándares de movilidad (Mínimo 2 de 3: k, v, r)",
            "category": "kvr",
            "passed": true,
            "severity": "medium",
            "score": 0.6666666666666666,
            "details": "k=True, v=True, r=False",
            "recommendation": null
        }
    ],
    "overall_compliance_score": 0.9166666666666666,
    "verdict": "SUCCESS",
    "analysis_text": "# INFORME TÉCNICO DE AUDITORÍA DE BAND STEERING\n\n## 1. RESUMEN EJECUTIVO\n**Veredicto:** SUCCESS  \n**Causa raíz del veredicto:** La prueba fue exitosa: se cumplieron los criterios de band steering.  \nDurante la auditoría se analizaron 199,162 paquetes WLAN, de los cuales se registraron 6 eventos 802.11. Se confirmó un intercambio BTM exitoso con un Status Code 0 (Accept), lo que indica una cooperación efectiva del cliente con el Access Point (AP). Se detectó un intento de steering que resultó en una transición exitosa, sin bucles ni desconexiones forzadas.\n\n## 2. ANÁLISIS DE PROTOCOLOS DE ROAMING (802.11k/v/r)\nSe identificaron los siguientes estándares de roaming:\n- **802.11k (Neighbor Reports):** Soporte confirmado.\n- **802.11v (BTM/WNM):** Soporte confirmado.\n\nEl cliente mostró un comportamiento cooperativo al responder a la BTM Request del AP, lo que se evidencia en la BTM Response con Status Code 0 (Accept). Esto sugiere que el cliente está preparado para recibir información sobre la red y tomar decisiones informadas sobre el roaming.\n\n## 3. ANÁLISIS DE TRANSICIONES DE BANDA\n- **Intentos de steering:** 1\n- **Transiciones exitosas:** 1\n- **Transiciones fallidas:** 0\n- **Bucles detectados:** NO\n\nEl único intento de steering resultó en una transición exitosa, lo que indica que el mecanismo de steering está funcionando correctamente. No se detectaron bucles, lo que es un indicador positivo de la estabilidad de la red.\n\n## 4. ESTABILIDAD DE ASOCIACIÓN\n- **Asociación y Reasociación:** \n  - Asociaciones: 0/0\n  - Reasociaciones: 2/4\n  - Desasociaciones: 0\n  - Desconexiones forzadas (Deauth): 0\n\nLa estabilidad de asociación es excelente, ya que no se registraron desconexiones forzadas ni desasociaciones. Esto contribuye a una experiencia de usuario fluida y sin interrupciones.\n\n## 5. CALIDAD DE RED\n- **TCP Retransmissions:** 0\n- **WLAN Retries:** 0\n- **DNS Errors:** 0\n\nLas métricas de calidad de red son óptimas, con cero retransmisiones TCP y WLAN, así como sin errores de DNS. Esto sugiere que la red está funcionando de manera eficiente y que no hay problemas de conectividad que puedan afectar la experiencia del usuario.\n\n## 6. COMPORTAMIENTO DEL CLIENTE\nEl cliente analizado mostró un alto nivel de cooperación con el AP, como se evidencia en la respuesta positiva a la BTM Request. Esto indica que el dispositivo está diseñado para aprovechar las capacidades de band steering y está optimizado para operar en entornos de múltiples bandas.\n\n## 7. CONCLUSIONES Y RECOMENDACIONES\nLa auditoría de band steering ha resultado exitosa, cumpliendo con todos los criterios establecidos. Se recomienda mantener la configuración actual del AP y continuar monitoreando el comportamiento del cliente para asegurar que se mantenga la eficiencia del steering. Además, se sugiere realizar auditorías periódicas para garantizar que la red siga cumpliendo con los estándares de calidad y rendimiento.\n\n**Próximos pasos sugeridos:**\n- Monitorear el rendimiento de la red y el comportamiento del cliente en diferentes condiciones de carga.\n- Evaluar la implementación de 802.11r para mejorar aún más la experiencia de roaming en entornos con alta movilidad.",
    "raw_stats": {
        "total_packets": 199162,
        "total_tcp_packets": 0,
        "total_wlan_packets": 199162,
        "approx_total_bytes": 0,
        "diagnostics": {
            "tcp_retransmissions": 0,
            "wlan_retries": 0,
            "dns_errors": 0,
            "steering_events_count": 6,
            "unique_bssid_count": 2,
            "bssid_info": {
                "f4:2d:06:43:49:3f": {
                    "band": "2.4GHz",
                    "ssid": "",
                    "frequency": "2412"
                },
                "f4:2d:06:43:49:40": {
                    "band": "5GHz",
                    "ssid": "483336303150",
                    "frequency": "5180"
                }
            },
            "client_mac": "ff:ff:ff:ff:ff:ff",
            "capture_quality": "VALIDA - Steering Preventivo (Client Steering) detectado",
            "band_counters": {
                "beacon_24": 11358,
                "beacon_5": 2306,
                "probe_req": 3376,
                "probe_resp_24": 4900,
                "probe_resp_5": 325,
                "data_24": 256,
                "data_5": 6160,
                "kvr_stats": {
                    "11k": true,
                    "11v": true,
                    "11r": false
                },
                "btm_stats": {
                    "requests": 1,
                    "responses": 1,
                    "status_codes": [
                        "0"
                    ]
                }
            }
        },
        "steering_analysis": {
            "transitions": [],
            "steering_attempts": 1,
            "successful_transitions": 1,
            "failed_transitions": 0,
            "loop_detected": false,
            "avg_transition_time": 0,
            "max_transition_time": 0,
            "transition_times": [],
            "verdict": "EXCELLENT",
            "clients_analyzed": 3,
            "preventive_steering": true
        },
        "steering_events": [
            {
                "timestamp": 1732743380.607895,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "f4:2d:06:43:49:3f",
                "bssid": "f4:2d:06:43:49:3f",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732743451.000931,
                "type": "Reassociation Request",
                "subtype": 2,
                "client_mac": "d8:cf:bf:4a:50:6f",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1732743451.002541,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "f4:2d:06:43:49:40",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732743561.957471,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "f4:2d:06:43:49:3f",
                "bssid": "f4:2d:06:43:49:3f",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732743624.357079,
                "type": "Reassociation Request",
                "subtype": 2,
                "client_mac": "d8:cf:bf:4a:50:6f",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1732743624.358719,
                "type": "Reassociation Response",
                "subtype": 3,
                "client_mac": "f4:2d:06:43:49:40",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            }
        ],
        "top_protocols": [
            [
                "radiotap",
                199162
            ],
            [
                "wlan_radio",
                199162
            ],
            [
                "wlan",
                199162
            ],
            [
                "data",
                6380
            ],
            [
                "llc",
                120
            ],
            [
                "ip",
                28
            ],
            [
                "tcp",
                28
            ],
            [
                "eapol",
                7
            ],
            [
                "arp",
                1
            ]
        ],
        "top_sources": [],
        "top_destinations": []
    },
    "fragments": []
}