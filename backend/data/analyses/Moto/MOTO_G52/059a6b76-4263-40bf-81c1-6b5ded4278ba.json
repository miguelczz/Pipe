{
    "analysis_id": "059a6b76-4263-40bf-81c1-6b5ded4278ba",
    "filename": "9.MOTO G52.pcapng",
    "analysis_timestamp": "2026-01-23T11:50:29.180320",
    "total_packets": 199162,
    "wlan_packets": 199162,
    "analysis_duration_ms": 0,
    "devices": [
        {
            "mac_address": "f4:2d:06:43:49:3f",
            "oui": "f4:2d:06",
            "vendor": "Moto",
            "device_model": "MOTO G52",
            "device_category": "mobile_device",
            "is_virtual": false,
            "confidence_score": 1.0
        }
    ],
    "btm_events": [],
    "transitions": [],
    "btm_requests": 1,
    "btm_responses": 1,
    "btm_success_rate": 1.0,
    "successful_transitions": 1,
    "failed_transitions": 0,
    "loops_detected": false,
    "kvr_support": {
        "k_support": true,
        "v_support": true,
        "r_support": false
    },
    "compliance_checks": [
        {
            "check_name": "Soporte BTM (802.11v)",
            "description": "El dispositivo debe demostrar soporte activo de BSS Transition Management",
            "category": "btm",
            "passed": true,
            "severity": "high",
            "details": "Requests: 1, Responses: 1\nCode: 0 (Accept)",
            "recommendation": "Habilitar 802.11v"
        },
        {
            "check_name": "Asociación y Reasociación",
            "description": "Verifica ciclos completos de asociación y reasociación",
            "category": "association",
            "passed": true,
            "severity": "medium",
            "details": "Assoc: 0/0, Reassoc: 2/4\nDisassoc: 0, Deauth: 0",
            "recommendation": null
        },
        {
            "check_name": "Steering Efectivo",
            "description": "Se deben realizar cambios de banda efectivos (2.4 -> 5GHz)",
            "category": "performance",
            "passed": true,
            "severity": "high",
            "details": "Cambios de banda: 1",
            "recommendation": null
        },
        {
            "check_name": "Estándares KVR",
            "description": "Soporte de estándares de movilidad (Mínimo 2 de 3: k, v, r)",
            "category": "kvr",
            "passed": true,
            "severity": "medium",
            "details": "k=True, v=True, r=False",
            "recommendation": null
        }
    ],
    "verdict": "SUCCESS",
    "analysis_text": "# INFORME TÉCNICO DE AUDITORÍA DE BAND STEERING\n\n## 1. RESUMEN EJECUTIVO\nEl veredicto de la auditoría es **EXITOSA**. La causa raíz del veredicto se basa en el cumplimiento de los criterios de band steering, donde se destaca un intercambio BTM (802.11v) exitoso con un Status Code 0 (Accept). Durante la captura se analizaron un total de 199,162 paquetes WLAN, de los cuales se registraron 6 eventos 802.11. Se observó un intento de steering que resultó en una transición exitosa, sin eventos de desconexión forzada ni bucles detectados.\n\n### Hallazgos Clave:\n- **Clientes analizados:** 3\n- **Intentos de steering:** 1\n- **Transiciones exitosas:** 1\n- **Transiciones fallidas:** 0\n- **Bucles detectados:** NO\n- **Tiempo promedio de transición:** 0s\n- **Tiempo máximo de transición:** 0s\n\n## 2. ANÁLISIS TÉCNICO\n\n### Análisis de Protocolos de Roaming (802.11k/v/r)\nSe detectaron los estándares 802.11k y 802.11v, lo que indica que el cliente tiene la capacidad de recibir informes de vecinos y gestionar transiciones de BSS. El análisis de BTM muestra que se realizó un BTM Request desde el AP hacia el cliente, seguido de una respuesta del cliente con un Status Code 0 (Accept), lo que confirma la cooperación del cliente en el proceso de steering.\n\n### Análisis de Transiciones de Banda\nSe registró un único intento de steering que resultó en una transición exitosa. No se detectaron transiciones fallidas, lo que sugiere que el cliente respondió adecuadamente a las solicitudes de cambio de banda. El tiempo promedio y máximo de transición fue de 0 segundos, lo que indica una respuesta inmediata del cliente al cambio de banda.\n\n### Estabilidad de Asociación\nNo se registraron eventos de desconexión forzada (Deauthentication) ni desasociaciones (Disassociation) durante la captura. Esto es un indicador positivo de la estabilidad de la conexión del cliente con el AP, lo que contribuye a una experiencia de usuario fluida y sin interrupciones.\n\n### Calidad de Red\nLos indicadores de red muestran un rendimiento óptimo, con 0 retransmisiones TCP, 0 reintentos WLAN y 0 errores DNS. Esto sugiere que la calidad de la red es excelente y que no hay problemas de conectividad que puedan afectar la experiencia del usuario.\n\n### Comportamiento del Cliente\nEl cliente analizado mostró un comportamiento cooperativo al responder positivamente a la solicitud de BTM. La capacidad de soportar los estándares 802.11k y 802.11v permite al cliente tomar decisiones informadas sobre el roaming, lo que mejora la eficiencia del band steering.\n\n## 3. CONCLUSIÓN FINAL\nLa auditoría de band steering ha sido **EXITOSA**, cumpliendo con todos los criterios establecidos. La cooperación del cliente en el proceso de BTM y la ausencia de desconexiones forzadas son indicadores de un entorno de red saludable y eficiente. Se recomienda mantener la configuración actual y seguir monitoreando el rendimiento para asegurar la continuidad de la calidad del servicio.",
    "raw_stats": {
        "total_packets": 199162,
        "total_tcp_packets": 0,
        "total_wlan_packets": 199162,
        "approx_total_bytes": 0,
        "diagnostics": {
            "tcp_retransmissions": 0,
            "wlan_retries": 0,
            "dns_errors": 0,
            "steering_events_count": 6,
            "unique_bssid_count": 2,
            "bssid_info": {
                "f4:2d:06:43:49:3f": {
                    "band": "2.4GHz",
                    "ssid": "",
                    "frequency": "2412"
                },
                "f4:2d:06:43:49:40": {
                    "band": "5GHz",
                    "ssid": "483336303150",
                    "frequency": "5180"
                }
            },
            "client_mac": "d4:ab:82:39:44:e1",
            "capture_quality": "VALIDA - Steering Preventivo (Client Steering) detectado",
            "band_counters": {
                "beacon_24": 11358,
                "beacon_5": 2306,
                "probe_req": 3376,
                "probe_resp_24": 4900,
                "probe_resp_5": 325,
                "data_24": 256,
                "data_5": 6160,
                "kvr_stats": {
                    "11k": true,
                    "11v": true,
                    "11r": false
                },
                "btm_stats": {
                    "requests": 1,
                    "responses": 1,
                    "status_codes": [
                        "0"
                    ]
                }
            }
        },
        "steering_analysis": {
            "transitions": [],
            "steering_attempts": 1,
            "successful_transitions": 1,
            "failed_transitions": 0,
            "loop_detected": false,
            "avg_transition_time": 0,
            "max_transition_time": 0,
            "transition_times": [],
            "verdict": "EXCELLENT",
            "clients_analyzed": 3,
            "preventive_steering": true
        },
        "steering_events": [
            {
                "timestamp": 1732743380.607895,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "f4:2d:06:43:49:3f",
                "da": "d8:cf:bf:4a:50:6f",
                "client_mac": "f4:2d:06:43:49:3f",
                "bssid": "f4:2d:06:43:49:3f",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732743451.000931,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "d8:cf:bf:4a:50:6f",
                "da": "f4:2d:06:43:49:40",
                "client_mac": "d8:cf:bf:4a:50:6f",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1732743451.002541,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "f4:2d:06:43:49:40",
                "da": "d8:cf:bf:4a:50:6f",
                "client_mac": "f4:2d:06:43:49:40",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732743561.957471,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "f4:2d:06:43:49:3f",
                "da": "d8:cf:bf:4a:50:6f",
                "client_mac": "f4:2d:06:43:49:3f",
                "bssid": "f4:2d:06:43:49:3f",
                "ssid": "",
                "band": "2.4GHz",
                "frequency": "2412",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            },
            {
                "timestamp": 1732743624.357079,
                "type": "Reassociation Request",
                "subtype": 2,
                "sa": "d8:cf:bf:4a:50:6f",
                "da": "f4:2d:06:43:49:40",
                "client_mac": "d8:cf:bf:4a:50:6f",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "483336303150",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": ""
            },
            {
                "timestamp": 1732743624.358719,
                "type": "Reassociation Response",
                "subtype": 3,
                "sa": "f4:2d:06:43:49:40",
                "da": "d8:cf:bf:4a:50:6f",
                "client_mac": "f4:2d:06:43:49:40",
                "bssid": "f4:2d:06:43:49:40",
                "ssid": "",
                "band": "5GHz",
                "frequency": "5180",
                "reason_code": "",
                "assoc_status_code": "0x0000"
            }
        ],
        "top_protocols": [
            [
                "radiotap",
                199162
            ],
            [
                "wlan_radio",
                199162
            ],
            [
                "wlan",
                199162
            ],
            [
                "data",
                6380
            ],
            [
                "llc",
                120
            ],
            [
                "ip",
                28
            ],
            [
                "tcp",
                28
            ],
            [
                "eapol",
                7
            ],
            [
                "arp",
                1
            ]
        ],
        "top_sources": [],
        "top_destinations": []
    },
    "fragments": []
}