{
    "analysis_id": "e3a07dd5-58a0-424a-8895-aa8810b6eb12",
    "filename": "test.pcap",
    "analysis_timestamp": "2026-01-23T11:59:15.108684",
    "total_packets": 0,
    "wlan_packets": 0,
    "analysis_duration_ms": 0,
    "devices": [
        {
            "mac_address": "Desconocido",
            "oui": "00:00:00",
            "vendor": "Unknown",
            "device_model": "test",
            "device_category": "unknown_device",
            "is_virtual": true,
            "confidence_score": 0.1
        }
    ],
    "btm_events": [],
    "transitions": [],
    "btm_requests": 0,
    "btm_responses": 0,
    "btm_success_rate": 0.0,
    "successful_transitions": 0,
    "failed_transitions": 0,
    "loops_detected": false,
    "kvr_support": {
        "k_support": false,
        "v_support": false,
        "r_support": false
    },
    "compliance_checks": [
        {
            "check_name": "Soporte BTM (802.11v)",
            "description": "El dispositivo debe demostrar soporte activo de BSS Transition Management",
            "category": "btm",
            "passed": false,
            "severity": "high",
            "details": "Requests: 0, Responses: 0",
            "recommendation": "El cliente ignora o rechaza solicitudes BTM. Revisar códigos de estado."
        },
        {
            "check_name": "Asociación y Reasociación",
            "description": "Verifica ciclos completos de asociación y reasociación",
            "category": "association",
            "passed": false,
            "severity": "medium",
            "details": "Assoc: 0/0, Reassoc: 0/0\nDisassoc: 0, Deauth: 0",
            "recommendation": "Handshake incompleto o captura parcial; no se detectó el ciclo completo de asociación."
        },
        {
            "check_name": "Steering Efectivo",
            "description": "Se deben realizar cambios de banda efectivos (2.4 -> 5GHz)",
            "category": "performance",
            "passed": false,
            "severity": "high",
            "details": "Cambios de banda: 0",
            "recommendation": "Ajustar umbrales de RSSI para forzar steering"
        },
        {
            "check_name": "Estándares KVR",
            "description": "Soporte de estándares de movilidad (Mínimo 2 de 3: k, v, r)",
            "category": "kvr",
            "passed": false,
            "severity": "medium",
            "details": "k=False, v=False, r=False",
            "recommendation": "Se recomienda habilitar el estándar faltante para roaming óptimo"
        }
    ],
    "verdict": "FAILED",
    "analysis_text": "# INFORME TÉCNICO DE AUDITORÍA DE BAND STEERING\n\n## 1. RESUMEN EJECUTIVO\n**Veredicto Final AIDLC:** FALLIDA\n\nLa auditoría de Band Steering ha sido calificada como FALLIDA debido a los siguientes checks que no se cumplieron:\n\n- **Soporte BTM (802.11v): FALLÓ**\n- **Asociación y Reasociación: FALLÓ**\n- **Steering Efectivo: FALLÓ**\n- **Estándares KVR: FALLÓ**\n\nDurante el análisis de la captura de Wireshark, se observó que no se registraron eventos 802.11, lo que indica una calidad de captura insuficiente. No se detectaron intentos de steering, transiciones exitosas o fallidas, y el cliente no mostró soporte para BSS Transition Management (BTM). Esto sugiere que el dispositivo no está configurado adecuadamente para gestionar el roaming entre bandas, lo que podría impactar negativamente en la experiencia del usuario.\n\n## 2. ANÁLISIS TÉCNICO\n\n### Soporte BTM (802.11v)\nEl análisis reveló que no se detectaron eventos relacionados con BTM, lo que indica que el cliente no está enviando ni respondiendo a solicitudes de gestión de transición de BSS. La ausencia de Requests y Responses (0/0) sugiere que el cliente ignora o rechaza activamente estas solicitudes. Esto limita la capacidad del cliente para realizar transiciones de banda efectivas y optimizadas.\n\n### Asociación y Reasociación\nNo se registraron eventos de asociación (Assoc: 0/0) ni de reasociación (Reassoc: 0/0). Esto indica que el ciclo completo de asociación no se completó, lo que puede ser resultado de una captura parcial o de un problema en la configuración del cliente. La falta de eventos de disasociación (Disassoc: 0) y desconexiones forzadas (Deauth: 0) refuerza la idea de que no se estableció una conexión activa entre el cliente y el punto de acceso.\n\n### Steering Efectivo\nLa auditoría mostró que no se realizaron cambios de banda efectivos (Cambios de banda: 0). Esto es crítico, ya que el objetivo del Band Steering es facilitar la transición de clientes entre bandas de 2.4GHz y 5GHz para optimizar el rendimiento de la red. La falta de cambios de banda sugiere que el cliente no está respondiendo a las condiciones de la red, lo que podría ser mejorado ajustando los umbrales de RSSI.\n\n### Estándares KVR\nEl análisis de los estándares de movilidad mostró que el cliente no soporta ninguno de los estándares requeridos (k=False, v=False, r=False). Esto es un factor limitante significativo, ya que la falta de soporte para al menos dos de los tres estándares (802.11k, 802.11v, 802.11r) impide que el cliente realice un roaming eficiente y rápido entre puntos de acceso.\n\n## 3. CONCLUSIÓN FINAL\nLa auditoría de Band Steering ha sido calificada como FALLIDA debido a la falta de soporte para BTM, la ausencia de eventos de asociación y reasociación, la ineficacia en el steering y la no conformidad con los estándares KVR. Se recomienda revisar la configuración del cliente y habilitar los estándares necesarios para mejorar la gestión del roaming y la experiencia del usuario en la red. La captura de datos debe ser revisada para asegurar que se realicen pruebas en condiciones óptimas, permitiendo así un análisis más completo en futuras auditorías.",
    "raw_stats": {
        "total_packets": 0,
        "total_tcp_packets": 0,
        "total_wlan_packets": 0,
        "approx_total_bytes": 0,
        "diagnostics": {
            "tcp_retransmissions": 0,
            "wlan_retries": 0,
            "dns_errors": 0,
            "steering_events_count": 0,
            "unique_bssid_count": 0,
            "bssid_info": {},
            "client_mac": "Desconocido",
            "capture_quality": "INSUFICIENTE - No hay eventos 802.11",
            "band_counters": {
                "beacon_24": 0,
                "beacon_5": 0,
                "probe_req": 0,
                "probe_resp_24": 0,
                "probe_resp_5": 0,
                "data_24": 0,
                "data_5": 0
            }
        },
        "steering_analysis": {
            "transitions": [],
            "steering_attempts": 0,
            "successful_transitions": 0,
            "failed_transitions": 0,
            "loop_detected": false,
            "avg_transition_time": 0,
            "max_transition_time": 0,
            "transition_times": [],
            "verdict": "NO_DATA",
            "clients_analyzed": 0,
            "preventive_steering": false
        },
        "steering_events": [],
        "top_protocols": [],
        "top_sources": [],
        "top_destinations": []
    },
    "fragments": []
}